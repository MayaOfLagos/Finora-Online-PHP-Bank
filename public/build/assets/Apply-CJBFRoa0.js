import{f as $,C as D,h as U,w as c,a as o,d as m,u as e,t as n,z as B,c as p,b as y,o as u,e as I,j as v,q as h,i as M}from"./app-CGXAIAlE.js";import{D as N}from"./DashboardLayout-DFU2WnNy.js";import{s as k}from"./index-DDlboOwb.js";import{a as w}from"./index-wsb1_vNM.js";import{s as T}from"./index-BJqs_rBw.js";import{s as V}from"./index-DDjFX1b8.js";import{s as R}from"./index-C7wi6bgs.js";import{s as j}from"./index-C0ds7PWA.js";/* empty css            */import"./index-CXbsaO0s.js";import"./index-BxqLMwpP.js";import"./index-DjlabTI3.js";import"./index-WYQojdR1.js";import"./index-__kL9Idw.js";import"./index-DrMM-Uwm.js";import"./AppLogo-BUbQmRUI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CGfXgJyN.js";import"./index-Tx8FIxxn.js";import"./index-BZysyzRQ.js";const F={class:"max-w-4xl mx-auto space-y-6"},P={class:"space-y-2"},O={class:"text-2xl font-bold"},q={class:"opacity-90"},z={class:"flex flex-wrap gap-6 mt-4 pt-4 border-t border-white/20"},E={class:"font-semibold"},Y={class:"font-semibold"},G={class:"font-bold text-xl"},H={key:0,class:"flex items-center gap-2"},J={class:"text-gray-500"},K={key:1},Q={class:"flex justify-between items-center"},W={class:"font-medium"},X={class:"text-sm text-gray-500"},Z={class:"text-sm font-semibold"},tt={key:0,class:"text-red-500"},ot={for:"amount",class:"block text-sm font-medium text-gray-700 mb-2"},et={key:0,class:"text-red-500"},st={key:0,class:"text-red-500"},nt={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3"},at={class:"grid grid-cols-3 gap-4"},lt={class:"text-xl font-bold text-blue-900"},rt={class:"text-xl font-bold text-orange-600"},mt={class:"text-xl font-bold text-blue-900"},it={class:"text-gray-500"},ut={key:0,class:"text-red-500"},dt={class:"flex gap-3"},It={__name:"Apply",props:{program:Object,accounts:Array},setup(l){const d=l,s=$({loan_type_id:d.program.id,bank_account_id:null,amount:null,term_months:12,purpose:""}),A=v(null),b=v(null);D([()=>s.amount,()=>s.term_months],()=>{if(!s.amount||!s.term_months||s.amount<d.program.min_amount||s.amount>d.program.max_amount){b.value=null;return}const r=s.amount,t=d.program.interest_rate/100/12,x=s.term_months,a=r*(t*Math.pow(1+t,x))/(Math.pow(1+t,x)-1),f=a*x;b.value={monthly:a,total:f,totalInterest:f-r}});const i=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),C=I(()=>{const r=[];for(let t=d.program.min_term_months;t<=d.program.max_term_months;t+=12)r.push({label:`${t} months (${t/12} ${t/12===1?"year":"years"})`,value:t});return r}),L=()=>{s.transform(r=>({...r,amount:Math.round((r.amount||0)*100)})).post(route("loans.store"),{onSuccess:()=>{h.visit("/loans/applications")}})},S=r=>{A.value=d.accounts.find(t=>t.id===r.value)};return(r,t)=>(u(),U(N,{title:"Apply for Loan"},{default:c(()=>[o("div",F,[m(e(k),{class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white"},{content:c(()=>[o("div",P,[o("h2",O,n(l.program.name),1),o("p",q,n(l.program.description),1),o("div",z,[o("div",null,[t[5]||(t[5]=o("p",{class:"text-sm opacity-80"},"Amount Range",-1)),o("p",E,n(i(l.program.min_amount))+" - "+n(i(l.program.max_amount)),1)]),o("div",null,[t[6]||(t[6]=o("p",{class:"text-sm opacity-80"},"Term Range",-1)),o("p",Y,n(l.program.min_term_months)+" - "+n(l.program.max_term_months)+" months",1)]),o("div",null,[t[7]||(t[7]=o("p",{class:"text-sm opacity-80"},"Interest Rate",-1)),o("p",G,n(l.program.interest_rate)+"%",1)])])])]),_:1}),m(e(k),null,{title:c(()=>[...t[8]||(t[8]=[M("Loan Application",-1)])]),content:c(()=>{var x;return[o("form",{onSubmit:B(L,["prevent"]),class:"space-y-6"},[o("div",null,[t[9]||(t[9]=o("label",{for:"bank_account",class:"block text-sm font-medium text-gray-700 mb-2"}," Disbursement Account * ",-1)),m(e(V),{id:"bank_account",modelValue:e(s).bank_account_id,"onUpdate:modelValue":t[0]||(t[0]=a=>e(s).bank_account_id=a),options:l.accounts,optionLabel:"account_number",optionValue:"id",placeholder:"Select account for loan disbursement",class:"w-full",onChange:S},{value:c(a=>{var f,_;return[a.value?(u(),p("div",H,[o("span",null,n((f=l.accounts.find(g=>g.id===a.value))==null?void 0:f.account_number),1),o("span",J,"- "+n((_=l.accounts.find(g=>g.id===a.value))==null?void 0:_.account_name),1)])):(u(),p("span",K,n(a.placeholder),1))]}),option:c(a=>[o("div",Q,[o("div",null,[o("div",W,n(a.option.account_number),1),o("div",X,n(a.option.account_name),1)]),o("div",Z,n(i(a.option.balance)),1)])]),_:1},8,["modelValue","options"]),e(s).errors.bank_account_id?(u(),p("small",tt,n(e(s).errors.bank_account_id),1)):y("",!0)]),o("div",null,[o("label",ot," Loan Amount * ("+n(i(l.program.min_amount))+" - "+n(i(l.program.max_amount))+") ",1),m(e(T),{id:"amount",modelValue:e(s).amount,"onUpdate:modelValue":t[1]||(t[1]=a=>e(s).amount=a),mode:"currency",currency:"USD",min:l.program.min_amount,max:l.program.max_amount,minFractionDigits:2,class:"w-full"},null,8,["modelValue","min","max"]),e(s).errors.amount?(u(),p("small",et,n(e(s).errors.amount),1)):y("",!0)]),o("div",null,[t[10]||(t[10]=o("label",{for:"term",class:"block text-sm font-medium text-gray-700 mb-2"}," Loan Term * ",-1)),m(e(V),{id:"term",modelValue:e(s).term_months,"onUpdate:modelValue":t[2]||(t[2]=a=>e(s).term_months=a),options:C.value,optionLabel:"label",optionValue:"value",placeholder:"Select loan term",class:"w-full"},null,8,["modelValue","options"]),e(s).errors.term_months?(u(),p("small",st,n(e(s).errors.term_months),1)):y("",!0)]),b.value?(u(),p("div",nt,[t[14]||(t[14]=o("h4",{class:"font-semibold text-blue-900"},"Loan Calculation",-1)),o("div",at,[o("div",null,[t[11]||(t[11]=o("p",{class:"text-sm text-blue-700"},"Monthly Payment",-1)),o("p",lt,n(i(b.value.monthly)),1)]),o("div",null,[t[12]||(t[12]=o("p",{class:"text-sm text-blue-700"},"Total Interest",-1)),o("p",rt,n(i(b.value.totalInterest)),1)]),o("div",null,[t[13]||(t[13]=o("p",{class:"text-sm text-blue-700"},"Total Payable",-1)),o("p",mt,n(i(b.value.total)),1)])])])):y("",!0),o("div",null,[t[15]||(t[15]=o("label",{for:"purpose",class:"block text-sm font-medium text-gray-700 mb-2"}," Purpose of Loan * ",-1)),m(e(R),{id:"purpose",modelValue:e(s).purpose,"onUpdate:modelValue":t[3]||(t[3]=a=>e(s).purpose=a),rows:"4",placeholder:"Please describe what you will use this loan for...",class:"w-full",maxlength:1e3},null,8,["modelValue"]),o("small",it,n(((x=e(s).purpose)==null?void 0:x.length)||0)+" / 1000 characters",1),t[16]||(t[16]=o("br",null,null,-1)),e(s).errors.purpose?(u(),p("small",ut,n(e(s).errors.purpose),1)):y("",!0)]),m(e(j),{severity:"warn"},{default:c(()=>[...t[17]||(t[17]=[o("p",{class:"text-sm"}," By submitting this application, you agree to our loan terms and conditions. Your application will be reviewed by our team, and you will be notified of the decision within 1-3 business days. ",-1)])]),_:1}),o("div",dt,[m(e(w),{type:"submit",label:"Submit Application",icon:"pi pi-check",loading:e(s).processing,disabled:!e(s).bank_account_id||!e(s).amount||!e(s).term_months||!e(s).purpose},null,8,["loading","disabled"]),m(e(w),{type:"button",label:"Cancel",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:t[4]||(t[4]=a=>e(h).visit("/loans/programs"))})])],32)]}),_:1})])]),_:1}))}};export{It as default};
