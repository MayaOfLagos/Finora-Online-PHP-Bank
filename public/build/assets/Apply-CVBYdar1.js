import{f as C,D,h as U,w as p,a as o,d as m,u as s,t as n,z as B,c as b,b as y,o as u,e as I,j as v,q as h,i as M}from"./app-BNwq58pk.js";import{D as N}from"./DashboardLayout-C9oKpSV2.js";import{s as k}from"./index-Dm5TEeWu.js";import{a as w}from"./index-CK_RaMIB.js";import{s as T}from"./index-BVu45HDP.js";import{s as V}from"./index-CE2KPnnt.js";import{s as R}from"./index-CFzQ8xfF.js";import{s as j}from"./index-CZkTvmC3.js";/* empty css            */import"./index-BlPXMWYH.js";import"./index-D6R1K7ML.js";import"./index-DYHwahjz.js";import"./index-BbqOEMnH.js";import"./index-DMLCVb4V.js";import"./index-D9gxfB09.js";import"./index-DqaT2hOw.js";import"./AppLogo-YPQqdRj8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CuHHdaJh.js";import"./index-DkrpQJOF.js";import"./index-CbO_FZUj.js";const F={class:"max-w-4xl mx-auto space-y-6"},P={class:"space-y-2"},E={class:"text-2xl font-bold"},O={class:"opacity-90"},q={class:"flex flex-wrap gap-6 mt-4 pt-4 border-t border-white/20"},z={class:"font-semibold"},Y={class:"font-semibold"},G={class:"font-bold text-xl"},H={key:0,class:"flex items-center gap-2"},J={class:"text-gray-500"},K={key:1},Q={class:"flex justify-between items-center"},W={class:"font-medium"},X={class:"text-sm text-gray-500"},Z={class:"text-sm font-semibold"},tt={key:0,class:"text-red-500"},ot={for:"amount",class:"block text-sm font-medium text-gray-700 mb-2"},et={key:0,class:"text-red-500"},st={key:0,class:"text-red-500"},nt={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3"},at={class:"grid grid-cols-3 gap-4"},lt={class:"text-xl font-bold text-blue-900"},rt={class:"text-xl font-bold text-orange-600"},mt={class:"text-xl font-bold text-blue-900"},it={class:"text-gray-500"},ut={key:0,class:"text-red-500"},ct={class:"flex gap-3"},Mt={__name:"Apply",props:{program:Object,accounts:Array},setup(l){const c=l,e=C({loan_type_id:c.program.id,bank_account_id:null,amount:null,term_months:12,purpose:""}),A=v(null),d=v(null);D([()=>e.amount,()=>e.term_months],()=>{if(e.errors.amount&&e.amount&&e.clearErrors("amount"),!e.amount||!e.term_months){d.value=null;return}if(e.amount<c.program.min_amount||e.amount>c.program.max_amount){d.value=null;return}const r=e.amount,t=c.program.interest_rate/100/12,f=e.term_months,a=r*(t*Math.pow(1+t,f))/(Math.pow(1+t,f)-1),x=a*f;d.value={monthly:a,total:x,totalInterest:x-r}});const i=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),L=I(()=>{const r=[];for(let t=c.program.min_term_months;t<=c.program.max_term_months;t+=12)r.push({label:`${t} months (${t/12} ${t/12===1?"year":"years"})`,value:t});return r}),S=()=>{e.transform(r=>({...r,amount:Math.round((r.amount||0)*100)})).post(route("loans.store"),{onSuccess:()=>{h.visit("/loans/applications")}})},$=r=>{A.value=c.accounts.find(t=>t.id===r.value)};return(r,t)=>(u(),U(N,{title:"Apply for Loan"},{default:p(()=>[o("div",F,[m(s(k),{class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white"},{content:p(()=>[o("div",P,[o("h2",E,n(l.program.name),1),o("p",O,n(l.program.description),1),o("div",q,[o("div",null,[t[5]||(t[5]=o("p",{class:"text-sm opacity-80"},"Amount Range",-1)),o("p",z,n(i(l.program.min_amount))+" - "+n(i(l.program.max_amount)),1)]),o("div",null,[t[6]||(t[6]=o("p",{class:"text-sm opacity-80"},"Term Range",-1)),o("p",Y,n(l.program.min_term_months)+" - "+n(l.program.max_term_months)+" months",1)]),o("div",null,[t[7]||(t[7]=o("p",{class:"text-sm opacity-80"},"Interest Rate",-1)),o("p",G,n(l.program.interest_rate)+"%",1)])])])]),_:1}),m(s(k),null,{title:p(()=>[...t[8]||(t[8]=[M("Loan Application",-1)])]),content:p(()=>{var f;return[o("form",{onSubmit:B(S,["prevent"]),class:"space-y-6"},[o("div",null,[t[9]||(t[9]=o("label",{for:"bank_account",class:"block text-sm font-medium text-gray-700 mb-2"}," Disbursement Account * ",-1)),m(s(V),{id:"bank_account",modelValue:s(e).bank_account_id,"onUpdate:modelValue":t[0]||(t[0]=a=>s(e).bank_account_id=a),options:l.accounts,optionLabel:"account_number",optionValue:"id",placeholder:"Select account for loan disbursement",class:"w-full",onChange:$},{value:p(a=>{var x,_;return[a.value?(u(),b("div",H,[o("span",null,n((x=l.accounts.find(g=>g.id===a.value))==null?void 0:x.account_number),1),o("span",J,"- "+n((_=l.accounts.find(g=>g.id===a.value))==null?void 0:_.account_name),1)])):(u(),b("span",K,n(a.placeholder),1))]}),option:p(a=>[o("div",Q,[o("div",null,[o("div",W,n(a.option.account_number),1),o("div",X,n(a.option.account_name),1)]),o("div",Z,n(i(a.option.balance)),1)])]),_:1},8,["modelValue","options"]),s(e).errors.bank_account_id?(u(),b("small",tt,n(s(e).errors.bank_account_id),1)):y("",!0)]),o("div",null,[o("label",ot," Loan Amount * ("+n(i(l.program.min_amount))+" - "+n(i(l.program.max_amount))+") ",1),m(s(T),{id:"amount",modelValue:s(e).amount,"onUpdate:modelValue":t[1]||(t[1]=a=>s(e).amount=a),mode:"currency",currency:"USD",min:l.program.min_amount,max:l.program.max_amount,minFractionDigits:2,class:"w-full"},null,8,["modelValue","min","max"]),s(e).errors.amount?(u(),b("small",et,n(s(e).errors.amount),1)):y("",!0)]),o("div",null,[t[10]||(t[10]=o("label",{for:"term",class:"block text-sm font-medium text-gray-700 mb-2"}," Loan Term * ",-1)),m(s(V),{id:"term",modelValue:s(e).term_months,"onUpdate:modelValue":t[2]||(t[2]=a=>s(e).term_months=a),options:L.value,optionLabel:"label",optionValue:"value",placeholder:"Select loan term",class:"w-full"},null,8,["modelValue","options"]),s(e).errors.term_months?(u(),b("small",st,n(s(e).errors.term_months),1)):y("",!0)]),d.value?(u(),b("div",nt,[t[14]||(t[14]=o("h4",{class:"font-semibold text-blue-900"},"Loan Calculation",-1)),o("div",at,[o("div",null,[t[11]||(t[11]=o("p",{class:"text-sm text-blue-700"},"Monthly Payment",-1)),o("p",lt,n(i(d.value.monthly)),1)]),o("div",null,[t[12]||(t[12]=o("p",{class:"text-sm text-blue-700"},"Total Interest",-1)),o("p",rt,n(i(d.value.totalInterest)),1)]),o("div",null,[t[13]||(t[13]=o("p",{class:"text-sm text-blue-700"},"Total Payable",-1)),o("p",mt,n(i(d.value.total)),1)])])])):y("",!0),o("div",null,[t[15]||(t[15]=o("label",{for:"purpose",class:"block text-sm font-medium text-gray-700 mb-2"}," Purpose of Loan * ",-1)),m(s(R),{id:"purpose",modelValue:s(e).purpose,"onUpdate:modelValue":t[3]||(t[3]=a=>s(e).purpose=a),rows:"4",placeholder:"Please describe what you will use this loan for...",class:"w-full",maxlength:1e3},null,8,["modelValue"]),o("small",it,n(((f=s(e).purpose)==null?void 0:f.length)||0)+" / 1000 characters",1),t[16]||(t[16]=o("br",null,null,-1)),s(e).errors.purpose?(u(),b("small",ut,n(s(e).errors.purpose),1)):y("",!0)]),m(s(j),{severity:"warn"},{default:p(()=>[...t[17]||(t[17]=[o("p",{class:"text-sm"}," By submitting this application, you agree to our loan terms and conditions. Your application will be reviewed by our team, and you will be notified of the decision within 1-3 business days. ",-1)])]),_:1}),o("div",ct,[m(s(w),{type:"submit",label:"Submit Application",icon:"pi pi-check",loading:s(e).processing,disabled:!s(e).bank_account_id||!s(e).amount||!s(e).term_months||!s(e).purpose},null,8,["loading","disabled"]),m(s(w),{type:"button",label:"Cancel",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:t[4]||(t[4]=a=>s(h).visit("/loans/programs"))})])],32)]}),_:1})])]),_:1}))}};export{Mt as default};
