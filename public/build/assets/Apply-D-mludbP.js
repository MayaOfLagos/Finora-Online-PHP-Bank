import{f as D,A as U,h as B,o as c,w as p,a as o,d as i,u as s,t as n,y as I,c as b,b as y,e as M,j as v,p as h,i as N}from"./app-BZqr0zL9.js";import{D as T}from"./DashboardLayout-Cb67E8M9.js";import{s as k}from"./index-DHMvfIj2.js";import{a as w}from"./index-CExWzsxC.js";import{s as R}from"./index-I8qWFFlq.js";import{s as V}from"./index-Fl3BKfBw.js";import{s as j}from"./index-D7HQVAf3.js";import{s as E}from"./index-D13A6RfK.js";/* empty css            */import"./index-CxB-UcZV.js";import"./index-H7ebdIEU.js";import"./index-s9Exw8Ft.js";import"./index-cobTmsOm.js";import"./index-B8kPkLyZ.js";import"./AppLogo-BBWxPWzz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LiveChatWidget-Dc9R9AEm.js";import"./PagePreloader-CyfFb8kD.js";import"./index-BH3IFnrd.js";import"./index-B-whclAp.js";import"./index-B4y3ad9I.js";import"./index-BAAY7xbj.js";const F={class:"max-w-4xl mx-auto space-y-6"},P={class:"space-y-2"},O={class:"text-2xl font-bold"},Y={class:"opacity-90"},q={class:"flex flex-wrap gap-6 mt-4 pt-4 border-t border-white/20"},z={class:"font-semibold"},G={class:"font-semibold"},H={class:"font-bold text-xl"},J={key:0,class:"flex items-center gap-2"},K={class:"text-gray-500"},Q={key:1},W={class:"flex justify-between items-center"},X={class:"font-medium"},Z={class:"text-sm text-gray-500"},tt={class:"text-sm font-semibold"},ot={key:0,class:"text-red-500"},et={for:"amount",class:"block text-sm font-medium text-gray-700 mb-2"},st={key:0,class:"text-red-500"},nt={key:0,class:"text-red-500"},at={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3"},lt={class:"grid grid-cols-3 gap-4"},rt={class:"text-xl font-bold text-blue-900"},mt={class:"text-xl font-bold text-orange-600"},it={class:"text-xl font-bold text-blue-900"},ut={class:"text-gray-500"},ct={key:0,class:"text-red-500"},dt={class:"flex gap-3"},Tt={__name:"Apply",props:{program:Object,accounts:Array},setup(l){const m=l,e=D({loan_type_id:m.program.id,bank_account_id:null,amount:null,term_months:12,purpose:""}),A=()=>{e.errors.amount&&e.amount>=m.program.min_amount&&e.amount<=m.program.max_amount&&e.clearErrors("amount")},L=v(null),d=v(null);U([()=>e.amount,()=>e.term_months],()=>{if(A(),!e.amount||!e.term_months){d.value=null;return}if(e.amount<m.program.min_amount||e.amount>m.program.max_amount){d.value=null;return}const r=e.amount,t=m.program.interest_rate/100/12,x=e.term_months,a=r*(t*Math.pow(1+t,x))/(Math.pow(1+t,x)-1),f=a*x;d.value={monthly:a,total:f,totalInterest:f-r}});const u=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),S=M(()=>{const r=[];for(let t=m.program.min_term_months;t<=m.program.max_term_months;t+=12)r.push({label:`${t} months (${t/12} ${t/12===1?"year":"years"})`,value:t});return r}),$=()=>{e.transform(r=>({...r,amount:Math.round((r.amount||0)*100)})).post(route("loans.store"),{onSuccess:()=>{h.visit("/loans/applications")}})},C=r=>{L.value=m.accounts.find(t=>t.id===r.value)};return(r,t)=>(c(),B(T,{title:"Apply for Loan"},{default:p(()=>[o("div",F,[i(s(k),{class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white"},{content:p(()=>[o("div",P,[o("h2",O,n(l.program.name),1),o("p",Y,n(l.program.description),1),o("div",q,[o("div",null,[t[5]||(t[5]=o("p",{class:"text-sm opacity-80"},"Amount Range",-1)),o("p",z,n(u(l.program.min_amount))+" - "+n(u(l.program.max_amount)),1)]),o("div",null,[t[6]||(t[6]=o("p",{class:"text-sm opacity-80"},"Term Range",-1)),o("p",G,n(l.program.min_term_months)+" - "+n(l.program.max_term_months)+" months",1)]),o("div",null,[t[7]||(t[7]=o("p",{class:"text-sm opacity-80"},"Interest Rate",-1)),o("p",H,n(l.program.interest_rate)+"%",1)])])])]),_:1}),i(s(k),null,{title:p(()=>[...t[8]||(t[8]=[N("Loan Application",-1)])]),content:p(()=>{var x;return[o("form",{onSubmit:I($,["prevent"]),class:"space-y-6"},[o("div",null,[t[9]||(t[9]=o("label",{for:"bank_account",class:"block text-sm font-medium text-gray-700 mb-2"}," Disbursement Account * ",-1)),i(s(V),{id:"bank_account",modelValue:s(e).bank_account_id,"onUpdate:modelValue":t[0]||(t[0]=a=>s(e).bank_account_id=a),options:l.accounts,optionLabel:"account_number",optionValue:"id",placeholder:"Select account for loan disbursement",class:"w-full",onChange:C},{value:p(a=>{var f,_;return[a.value?(c(),b("div",J,[o("span",null,n((f=l.accounts.find(g=>g.id===a.value))==null?void 0:f.account_number),1),o("span",K,"- "+n((_=l.accounts.find(g=>g.id===a.value))==null?void 0:_.account_name),1)])):(c(),b("span",Q,n(a.placeholder),1))]}),option:p(a=>[o("div",W,[o("div",null,[o("div",X,n(a.option.account_number),1),o("div",Z,n(a.option.account_name),1)]),o("div",tt,n(u(a.option.balance)),1)])]),_:1},8,["modelValue","options"]),s(e).errors.bank_account_id?(c(),b("small",ot,n(s(e).errors.bank_account_id),1)):y("",!0)]),o("div",null,[o("label",et," Loan Amount * ("+n(u(l.program.min_amount))+" - "+n(u(l.program.max_amount))+") ",1),i(s(R),{id:"amount",modelValue:s(e).amount,"onUpdate:modelValue":t[1]||(t[1]=a=>s(e).amount=a),mode:"currency",currency:"USD",min:l.program.min_amount,max:l.program.max_amount,minFractionDigits:2,class:"w-full"},null,8,["modelValue","min","max"]),s(e).errors.amount?(c(),b("small",st,n(s(e).errors.amount),1)):y("",!0)]),o("div",null,[t[10]||(t[10]=o("label",{for:"term",class:"block text-sm font-medium text-gray-700 mb-2"}," Loan Term * ",-1)),i(s(V),{id:"term",modelValue:s(e).term_months,"onUpdate:modelValue":t[2]||(t[2]=a=>s(e).term_months=a),options:S.value,optionLabel:"label",optionValue:"value",placeholder:"Select loan term",class:"w-full"},null,8,["modelValue","options"]),s(e).errors.term_months?(c(),b("small",nt,n(s(e).errors.term_months),1)):y("",!0)]),d.value?(c(),b("div",at,[t[14]||(t[14]=o("h4",{class:"font-semibold text-blue-900"},"Loan Calculation",-1)),o("div",lt,[o("div",null,[t[11]||(t[11]=o("p",{class:"text-sm text-blue-700"},"Monthly Payment",-1)),o("p",rt,n(u(d.value.monthly)),1)]),o("div",null,[t[12]||(t[12]=o("p",{class:"text-sm text-blue-700"},"Total Interest",-1)),o("p",mt,n(u(d.value.totalInterest)),1)]),o("div",null,[t[13]||(t[13]=o("p",{class:"text-sm text-blue-700"},"Total Payable",-1)),o("p",it,n(u(d.value.total)),1)])])])):y("",!0),o("div",null,[t[15]||(t[15]=o("label",{for:"purpose",class:"block text-sm font-medium text-gray-700 mb-2"}," Purpose of Loan * ",-1)),i(s(j),{id:"purpose",modelValue:s(e).purpose,"onUpdate:modelValue":t[3]||(t[3]=a=>s(e).purpose=a),rows:"4",placeholder:"Please describe what you will use this loan for...",class:"w-full",maxlength:1e3},null,8,["modelValue"]),o("small",ut,n(((x=s(e).purpose)==null?void 0:x.length)||0)+" / 1000 characters",1),t[16]||(t[16]=o("br",null,null,-1)),s(e).errors.purpose?(c(),b("small",ct,n(s(e).errors.purpose),1)):y("",!0)]),i(s(E),{severity:"warn"},{default:p(()=>[...t[17]||(t[17]=[o("p",{class:"text-sm"}," By submitting this application, you agree to our loan terms and conditions. Your application will be reviewed by our team, and you will be notified of the decision within 1-3 business days. ",-1)])]),_:1}),o("div",dt,[i(s(w),{type:"submit",label:"Submit Application",icon:"pi pi-check",loading:s(e).processing,disabled:!s(e).bank_account_id||!s(e).amount||!s(e).term_months||!s(e).purpose},null,8,["loading","disabled"]),i(s(w),{type:"button",label:"Cancel",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:t[4]||(t[4]=a=>s(h).visit("/loans/programs"))})])],32)]}),_:1})])]),_:1}))}};export{Tt as default};
