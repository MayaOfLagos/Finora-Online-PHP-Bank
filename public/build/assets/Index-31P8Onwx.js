import{k as Y,e as k,f as W,h as T,w as r,a as e,d as l,u as s,c as d,b as v,x as $,o as n,t as i,i as _,F,r as B,j as h,A as q}from"./app-DJNUep7O.js";import{D as z}from"./DashboardLayout-CI4qHZj7.js";import{s as w}from"./index-DmPX9sJY.js";import{s as G}from"./index-izyJo8sr.js";import{s as H}from"./index-C8XJCf9b.js";import{a as b}from"./index-DGSchmoo.js";import{s as J}from"./index-CAeyKKGl.js";import{s as V}from"./index-5IoXtwkj.js";import{s as L}from"./index-Czm-ECtU.js";import{s as Q}from"./index-BX8UgM-h.js";import{s as X}from"./index-D72Sy5fd.js";/* empty css            */import"./index-BL50WqTB.js";import"./index-CvwZXNlA.js";import"./index-B37yR2CL.js";import"./index-Bhr1yaRb.js";import"./index-4Nmgfxef.js";import"./AppLogo-CmA--Bz-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CSijVqFb.js";import"./index-BCJZTrr0.js";const Z={class:"space-y-6"},ee={class:"grid gap-6 lg:grid-cols-3"},te={class:"grid gap-4 md:grid-cols-2"},se={class:"md:col-span-2"},ae={key:0,class:"text-sm text-red-500 mt-1"},oe={class:"md:col-span-2"},le={class:"flex justify-between items-center w-full"},re={class:"text-gray-500 text-sm"},ie={key:0},ne={key:1,class:"text-gray-400"},de={key:0,class:"text-sm text-red-500 mt-1"},ce={class:"md:col-span-2 flex justify-end"},ue={class:"space-y-3"},pe={class:"text-sm text-gray-600 dark:text-gray-400"},me={class:"font-semibold text-gray-900 dark:text-white"},fe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},ye={class:"flex items-center justify-between"},xe={class:"font-semibold text-gray-900 dark:text-white"},ve={class:"text-sm text-gray-600 dark:text-gray-400"},be={class:"text-sm text-gray-600 dark:text-gray-400"},ge={class:"text-xs text-gray-500"},_e={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},ke={class:"space-y-4"},he={class:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 space-y-2"},we={class:"flex justify-between"},Ve={class:"font-bold text-gray-900 dark:text-white"},Ce={class:"flex justify-between"},Ne={class:"font-medium text-gray-900 dark:text-white"},Ee={class:"flex justify-end gap-2"},Ae={class:"space-y-4"},je={class:"flex flex-col items-center gap-2"},Pe={key:0,class:"text-sm text-red-500"},Ue={class:"flex justify-end gap-2"},Ze={__name:"Index",props:{vouchers:{type:Object,default:()=>({data:[]})},stats:{type:Object,default:()=>({})},bankAccounts:{type:Array,default:()=>[]}},setup(y){var S,I,R;const u=y,M=q(),C=k(()=>M.props.flash),N=Y();(S=C.value)!=null&&S.success&&N.add({severity:"success",summary:"Success",detail:C.value.success,life:4e3});const a=W({voucher_code:"",bank_account_id:((R=(I=u.bankAccounts)==null?void 0:I[0])==null?void 0:R.id)??null,pin:""}),x=h(!1),p=h(!1),m=h(!1),E=(f,t="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format((f||0)/100),A={active:{label:"Active",severity:"success"},used:{label:"Used",severity:"secondary"},expired:{label:"Expired",severity:"danger"}},g=k(()=>u.bankAccounts.find(f=>f.id===a.bank_account_id)),j=()=>{if(!a.voucher_code||!a.bank_account_id){a.voucher_code||a.setError("voucher_code","Please enter a voucher code"),a.bank_account_id||a.setError("bank_account_id","Please select an account");return}a.clearErrors(),x.value=!0},K=()=>{x.value=!1,a.pin="",p.value=!0},P=()=>{if(a.pin.length!==6){a.setError("pin","PIN must be 6 digits");return}m.value=!0,a.post("/vouchers/redeem",{preserveScroll:!0,onSuccess:()=>{p.value=!1,a.reset("voucher_code","pin"),N.add({severity:"success",summary:"Voucher Redeemed!",detail:"Check your email for confirmation.",life:4e3})},onError:f=>{f.pin||(p.value=!1)},onFinish:()=>{m.value=!1}})},U=()=>{x.value=!1,p.value=!1,a.pin=""},O=k(()=>[{label:"Active",value:u.stats.active??0},{label:"Used",value:u.stats.used??0},{label:"Expired",value:u.stats.expired??0},{label:"Total Value Used",value:E((u.stats.total_value??0)*100)}]);return(f,t)=>(n(),T(z,{title:"Vouchers"},{default:r(()=>[e("div",Z,[t[11]||(t[11]=e("div",{class:"space-y-1"},[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Vouchers"),e("p",{class:"text-gray-600 dark:text-gray-400"},"Redeem vouchers to credit your accounts.")],-1)),e("div",ee,[l(s(w),{class:"lg:col-span-2"},{title:r(()=>[...t[5]||(t[5]=[_("Redeem Voucher",-1)])]),content:r(()=>[e("div",te,[e("div",se,[t[6]||(t[6]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Voucher Code",-1)),l(s(G),{modelValue:s(a).voucher_code,"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).voucher_code=o),placeholder:"ENTER-CODE",class:"w-full mt-1 uppercase",onKeyup:$(j,["enter"])},null,8,["modelValue"]),s(a).errors.voucher_code?(n(),d("p",ae,i(s(a).errors.voucher_code),1)):v("",!0)]),e("div",oe,[t[8]||(t[8]=e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Deposit To",-1)),l(s(H),{modelValue:s(a).bank_account_id,"onUpdate:modelValue":t[1]||(t[1]=o=>s(a).bank_account_id=o),options:y.bankAccounts,optionLabel:"account_number",optionValue:"id",class:"w-full mt-1",placeholder:"Select account"},{option:r(({option:o})=>{var c;return[e("div",le,[e("span",null,i(o.account_name),1),e("span",re,"****"+i((c=o.account_number)==null?void 0:c.slice(-4)),1)])]}),value:r(({value:o})=>{var c;return[g.value?(n(),d("span",ie,i(g.value.account_name)+" - ****"+i((c=g.value.account_number)==null?void 0:c.slice(-4)),1)):(n(),d("span",ne,"Select account"))]}),_:1},8,["modelValue","options"]),s(a).errors.bank_account_id?(n(),d("p",de,i(s(a).errors.bank_account_id),1)):v("",!0),y.bankAccounts.length?v("",!0):(n(),T(s(V),{key:1,severity:"warn",closable:!1,class:"mt-2"},{default:r(()=>[...t[7]||(t[7]=[_("No bank accounts found. Add an account first.",-1)])]),_:1}))]),e("div",ce,[l(s(b),{label:"Redeem Voucher",icon:"pi pi-ticket",disabled:!s(a).voucher_code||!s(a).bank_account_id,onClick:j},null,8,["disabled"])])])]),_:1}),l(s(w),null,{title:r(()=>[...t[9]||(t[9]=[_("Stats",-1)])]),content:r(()=>[e("div",ue,[(n(!0),d(F,null,B(O.value,o=>(n(),d("div",{key:o.label,class:"flex items-center justify-between p-3 border rounded-xl dark:border-gray-700"},[e("span",pe,i(o.label),1),e("span",me,i(o.value),1)]))),128))])]),_:1})]),l(s(w),null,{title:r(()=>[...t[10]||(t[10]=[_("Your Vouchers",-1)])]),content:r(()=>[e("div",fe,[(n(!0),d(F,null,B(y.vouchers.data,o=>{var c,D;return n(),d("div",{key:o.id,class:"p-4 border rounded-xl dark:border-gray-700 bg-white dark:bg-gray-800 space-y-2"},[e("div",ye,[e("h3",xe,i(o.code),1),l(s(J),{value:((c=A[o.status])==null?void 0:c.label)||o.status,severity:((D=A[o.status])==null?void 0:D.severity)||"info"},null,8,["value","severity"])]),e("p",ve,"Value: "+i(E(o.amount,o.currency||"USD")),1),e("p",be,"Expires: "+i(o.expires_at||"N/A"),1),e("p",ge,i(o.description||"Voucher credit"),1)])}),128))]),y.vouchers.data.length?v("",!0):(n(),d("p",_e,"No vouchers yet."))]),_:1})]),l(s(L),{visible:x.value,"onUpdate:visible":t[2]||(t[2]=o=>x.value=o),modal:"",header:"Confirm Voucher Redemption",style:{width:"450px"},closable:!0},{footer:r(()=>[e("div",Ee,[l(s(b),{label:"Cancel",severity:"secondary",outlined:"",onClick:U}),l(s(b),{label:"Continue",icon:"pi pi-arrow-right",onClick:K})])]),default:r(()=>{var o;return[e("div",ke,[t[15]||(t[15]=e("div",{class:"text-center"},[e("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center"},[e("i",{class:"pi pi-ticket text-3xl text-green-600 dark:text-green-400"})]),e("p",{class:"text-gray-700 dark:text-gray-300"},"You are about to redeem the following voucher:")],-1)),e("div",he,[e("div",we,[t[12]||(t[12]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Voucher Code:",-1)),e("span",Ve,i(s(a).voucher_code.toUpperCase()),1)]),l(s(X)),e("div",Ce,[t[13]||(t[13]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Deposit To:",-1)),e("span",Ne,i(((o=g.value)==null?void 0:o.account_name)||"Selected Account"),1)])]),l(s(V),{severity:"info",closable:!1},{default:r(()=>[...t[14]||(t[14]=[e("span",{class:"text-sm"},"You will need to enter your 6-digit PIN to confirm this transaction.",-1)])]),_:1})])]}),_:1},8,["visible"]),l(s(L),{visible:p.value,"onUpdate:visible":t[4]||(t[4]=o=>p.value=o),modal:"",header:"Enter Transaction PIN",style:{width:"400px"},closable:!m.value},{footer:r(()=>[e("div",Ue,[l(s(b),{label:"Cancel",severity:"secondary",outlined:"",disabled:m.value,onClick:U},null,8,["disabled"]),l(s(b),{label:"Confirm & Redeem",icon:"pi pi-check",loading:m.value,disabled:s(a).pin.length!==6,onClick:P},null,8,["loading","disabled"])])]),default:r(()=>[e("div",Ae,[t[17]||(t[17]=e("div",{class:"text-center"},[e("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center"},[e("i",{class:"pi pi-lock text-3xl text-blue-600 dark:text-blue-400"})]),e("p",{class:"text-gray-700 dark:text-gray-300"},"Enter your 6-digit transaction PIN to confirm redemption")],-1)),e("div",je,[l(s(Q),{modelValue:s(a).pin,"onUpdate:modelValue":t[3]||(t[3]=o=>s(a).pin=o),placeholder:"Enter PIN",feedback:!1,toggleMask:"",inputClass:"w-full text-center text-2xl tracking-[0.5em] font-mono",maxlength:6,disabled:m.value,onKeyup:$(P,["enter"])},null,8,["modelValue","disabled"]),s(a).errors.pin?(n(),d("p",Pe,i(s(a).errors.pin),1)):v("",!0)]),l(s(V),{severity:"warn",closable:!1},{default:r(()=>[...t[16]||(t[16]=[e("span",{class:"text-sm"},"Never share your PIN with anyone. Finora Bank will never ask for your PIN via email or phone.",-1)])]),_:1})])]),_:1},8,["visible","closable"])]),_:1}))}};export{Ze as default};
