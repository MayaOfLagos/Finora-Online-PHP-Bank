import{k as N,f as T,e as D,E as M,g as O,w as u,a as t,d as r,u as s,c as d,b as A,o as i,t as c,i as g,j as U,F as B,r as S,a1 as q}from"./app-BXhd72r4.js";import{_ as I}from"./DashboardLayout-CROH8gRb.js";import{s as _}from"./index-CdZZBDPy.js";import{s as b}from"./index-BJlS0bsC.js";import{s as Q}from"./index-BomhZbXo.js";import{a as z}from"./index-p8MMPEpC.js";import{s as G}from"./index-DwcA1GJt.js";import{s as H}from"./index-Bcw-br6-.js";import{s as J}from"./index-cNyFxpWT.js";/* empty css            */import"./index-Cm1bONHA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D8Uajx-C.js";import"./index-Diib7DfT.js";const K={class:"space-y-6"},P={class:"grid gap-6 lg:grid-cols-3"},W={class:"grid gap-4 md:grid-cols-2"},X={class:"space-y-1 md:col-span-2"},Y={key:0,class:"text-sm text-red-500"},Z={class:"space-y-1"},ee={class:"space-y-1"},te={class:"space-y-1 md:col-span-2"},se={key:0,class:"text-sm text-red-500"},ae={class:"md:col-span-2 flex justify-end"},oe={key:0,class:"space-y-3"},re={class:"flex items-center justify-between"},le={class:"flex items-center justify-between"},ne={class:"text-lg font-semibold text-gray-900 dark:text-white"},ie={class:"flex items-center justify-between"},ce={class:"text-gray-900 dark:text-white"},ue={class:"flex items-center justify-between"},de={class:"text-xl font-bold text-emerald-600"},me={key:1,class:"space-y-2"},pe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},ye={class:"text-sm font-semibold text-gray-900 dark:text-white"},xe={class:"mt-2 space-y-1 text-sm text-gray-700 dark:text-gray-300"},Ae={__name:"Index",props:{bankAccounts:{type:Array,default:()=>[]},exchangeRates:{type:Object,default:()=>({})}},setup(v){var h,F,R,$,j,E;const k=v,w=N(),x=D(()=>Object.keys(k.exchangeRates).map(n=>({label:n,value:n}))),a=T({bank_account_id:((F=(h=k.bankAccounts)==null?void 0:h[0])==null?void 0:F.id)??null,from_currency:(($=(R=x.value)==null?void 0:R[0])==null?void 0:$.value)??"USD",to_currency:((E=(j=x.value)==null?void 0:j[1])==null?void 0:E.value)??"EUR",amount:100}),l=U(null),V=U(!1);M(()=>[a.from_currency,a.to_currency,a.amount],async()=>{var n,e;if(!(!a.from_currency||!a.to_currency||!a.amount)){V.value=!0;try{const{data:o}=await q.post("/exchange/rate",{from_currency:a.from_currency,to_currency:a.to_currency,amount:a.amount});l.value=o}catch(o){w.add({severity:"error",summary:"Rate unavailable",detail:((e=(n=o.response)==null?void 0:n.data)==null?void 0:e.message)||"Could not fetch rate.",life:3e3})}finally{V.value=!1}}},{immediate:!0});const L=()=>{a.transform(n=>({...n,amount:Math.round((n.amount||0)*100)})).post("/exchange",{preserveScroll:!0,onSuccess:()=>w.add({severity:"success",summary:"Exchanged",detail:"Currency converted.",life:2500})})};return(n,e)=>(i(),O(I,{title:"Exchange Money"},{default:u(()=>[t("div",K,[e[16]||(e[16]=t("div",{class:"flex flex-col gap-2"},[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Exchange Money"),t("p",{class:"text-gray-600 dark:text-gray-400"},"Convert between currencies using your Finora accounts.")],-1)),t("div",P,[r(s(_),{class:"lg:col-span-2"},{title:u(()=>[...e[4]||(e[4]=[g("Conversion",-1)])]),content:u(()=>[t("div",W,[t("div",X,[e[5]||(e[5]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From Account",-1)),r(s(b),{modelValue:s(a).bank_account_id,"onUpdate:modelValue":e[0]||(e[0]=o=>s(a).bank_account_id=o),options:v.bankAccounts,optionLabel:"account_number",optionValue:"id",class:"w-full",placeholder:"Select account"},null,8,["modelValue","options"]),s(a).errors.bank_account_id?(i(),d("p",Y,c(s(a).errors.bank_account_id),1)):A("",!0)]),t("div",Z,[e[6]||(e[6]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From",-1)),r(s(b),{modelValue:s(a).from_currency,"onUpdate:modelValue":e[1]||(e[1]=o=>s(a).from_currency=o),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),t("div",ee,[e[7]||(e[7]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"To",-1)),r(s(b),{modelValue:s(a).to_currency,"onUpdate:modelValue":e[2]||(e[2]=o=>s(a).to_currency=o),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),t("div",te,[e[8]||(e[8]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"Amount",-1)),r(s(Q),{modelValue:s(a).amount,"onUpdate:modelValue":e[3]||(e[3]=o=>s(a).amount=o),mode:"decimal",min:1,maxFractionDigits:2,class:"w-full",placeholder:"0.00"},null,8,["modelValue"]),s(a).errors.amount?(i(),d("p",se,c(s(a).errors.amount),1)):A("",!0)]),t("div",ae,[r(s(z),{label:"Exchange",icon:"pi pi-sync",loading:s(a).processing,onClick:L},null,8,["loading"])])])]),_:1}),r(s(_),null,{title:u(()=>[...e[9]||(e[9]=[g("Quote",-1)])]),content:u(()=>{var o,p,m,y,f,C;return[l.value?(i(),d("div",oe,[t("div",re,[e[10]||(e[10]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Rate",-1)),r(s(G),{severity:"info",value:`1 ${s(a).from_currency} = ${l.value.rate} ${s(a).to_currency}`},null,8,["value"])]),t("div",le,[e[11]||(e[11]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Converted",-1)),t("span",ne,c(((p=(o=l.value.converted_amount)==null?void 0:o.toFixed)==null?void 0:p.call(o,2))??l.value.converted_amount),1)]),t("div",ie,[e[12]||(e[12]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Fee (1%)",-1)),t("span",ce,c(((y=(m=l.value.fee)==null?void 0:m.toFixed)==null?void 0:y.call(m,2))??l.value.fee),1)]),r(s(J)),t("div",ue,[e[13]||(e[13]=t("span",{class:"font-semibold text-gray-900 dark:text-white"},"Total Received",-1)),t("span",de,c(((C=(f=l.value.total)==null?void 0:f.toFixed)==null?void 0:C.call(f,2))??l.value.total)+" "+c(s(a).to_currency),1)])])):(i(),d("div",me,[r(s(H),{severity:"secondary",closable:!1},{default:u(()=>[...e[14]||(e[14]=[g("Enter an amount to see a live quote.",-1)])]),_:1})]))]}),_:1})]),r(s(_),null,{title:u(()=>[...e[15]||(e[15]=[g("Available Rates",-1)])]),content:u(()=>[t("div",pe,[(i(!0),d(B,null,S(v.exchangeRates,(o,p)=>(i(),d("div",{key:p,class:"p-4 border rounded-xl dark:border-gray-700"},[t("p",ye,"Base: "+c(p),1),t("div",xe,[(i(!0),d(B,null,S(o,(m,y)=>(i(),d("div",{key:y,class:"flex justify-between"},[t("span",null,c(y),1),t("span",null,c(m),1)]))),128))])]))),128))])]),_:1})])]),_:1}))}};export{Ae as default};
