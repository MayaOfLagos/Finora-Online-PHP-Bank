import{k as N,f as T,e as D,G as M,g as O,w as u,a as e,d as r,u as s,c as d,b as A,o as i,t as c,i as g,j as U,F as B,r as S,a2 as q}from"./app-D0L7qcI-.js";import{_ as G}from"./DashboardLayout-BELNjoUN.js";import{s as _}from"./index-D4Peetgf.js";import{s as b}from"./index-p-nqNRNI.js";import{s as I}from"./index-dh-gwQ0B.js";import{a as Q}from"./index-_afBV8n0.js";import{s as z}from"./index-evs_6PBV.js";import{s as H}from"./index-du4gADrq.js";import{s as J}from"./index-BwOar0qb.js";/* empty css            */import"./index-DuHIcdlR.js";import"./index-DmN-Xh3u.js";import"./index-f-CKhQTu.js";import"./index-231ux3V2.js";import"./index-CPrIDt6n.js";import"./AppLogo-B7oc-OtX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BEA53qj_.js";import"./index-wyxgjzze.js";const K={class:"space-y-6"},P={class:"grid gap-6 lg:grid-cols-3"},W={class:"grid gap-4 md:grid-cols-2"},X={class:"space-y-1 md:col-span-2"},Y={key:0,class:"text-sm text-red-500"},Z={class:"space-y-1"},tt={class:"space-y-1"},et={class:"space-y-1 md:col-span-2"},st={key:0,class:"text-sm text-red-500"},at={class:"md:col-span-2 flex justify-end"},ot={key:0,class:"space-y-3"},rt={class:"flex items-center justify-between"},lt={class:"flex items-center justify-between"},nt={class:"text-lg font-semibold text-gray-900 dark:text-white"},it={class:"flex items-center justify-between"},ct={class:"text-gray-900 dark:text-white"},ut={class:"flex items-center justify-between"},dt={class:"text-xl font-bold text-emerald-600"},mt={key:1,class:"space-y-2"},pt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},yt={class:"text-sm font-semibold text-gray-900 dark:text-white"},xt={class:"mt-2 space-y-1 text-sm text-gray-700 dark:text-gray-300"},Nt={__name:"Index",props:{bankAccounts:{type:Array,default:()=>[]},exchangeRates:{type:Object,default:()=>({})}},setup(v){var h,F,R,$,j,C;const k=v,w=N(),x=D(()=>Object.keys(k.exchangeRates).map(n=>({label:n,value:n}))),a=T({bank_account_id:((F=(h=k.bankAccounts)==null?void 0:h[0])==null?void 0:F.id)??null,from_currency:(($=(R=x.value)==null?void 0:R[0])==null?void 0:$.value)??"USD",to_currency:((C=(j=x.value)==null?void 0:j[1])==null?void 0:C.value)??"EUR",amount:100}),l=U(null),V=U(!1);M(()=>[a.from_currency,a.to_currency,a.amount],async()=>{var n,t;if(!(!a.from_currency||!a.to_currency||!a.amount)){V.value=!0;try{const{data:o}=await q.post("/exchange/rate",{from_currency:a.from_currency,to_currency:a.to_currency,amount:a.amount});l.value=o}catch(o){w.add({severity:"error",summary:"Rate unavailable",detail:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.message)||"Could not fetch rate.",life:3e3})}finally{V.value=!1}}},{immediate:!0});const L=()=>{a.transform(n=>({...n,amount:Math.round((n.amount||0)*100)})).post("/exchange",{preserveScroll:!0,onSuccess:()=>w.add({severity:"success",summary:"Exchanged",detail:"Currency converted.",life:2500})})};return(n,t)=>(i(),O(G,{title:"Exchange Money"},{default:u(()=>[e("div",K,[t[16]||(t[16]=e("div",{class:"flex flex-col gap-2"},[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Exchange Money"),e("p",{class:"text-gray-600 dark:text-gray-400"},"Convert between currencies using your Finora accounts.")],-1)),e("div",P,[r(s(_),{class:"lg:col-span-2"},{title:u(()=>[...t[4]||(t[4]=[g("Conversion",-1)])]),content:u(()=>[e("div",W,[e("div",X,[t[5]||(t[5]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From Account",-1)),r(s(b),{modelValue:s(a).bank_account_id,"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).bank_account_id=o),options:v.bankAccounts,optionLabel:"account_number",optionValue:"id",class:"w-full",placeholder:"Select account"},null,8,["modelValue","options"]),s(a).errors.bank_account_id?(i(),d("p",Y,c(s(a).errors.bank_account_id),1)):A("",!0)]),e("div",Z,[t[6]||(t[6]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From",-1)),r(s(b),{modelValue:s(a).from_currency,"onUpdate:modelValue":t[1]||(t[1]=o=>s(a).from_currency=o),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),e("div",tt,[t[7]||(t[7]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"To",-1)),r(s(b),{modelValue:s(a).to_currency,"onUpdate:modelValue":t[2]||(t[2]=o=>s(a).to_currency=o),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),e("div",et,[t[8]||(t[8]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"Amount",-1)),r(s(I),{modelValue:s(a).amount,"onUpdate:modelValue":t[3]||(t[3]=o=>s(a).amount=o),mode:"decimal",min:1,maxFractionDigits:2,class:"w-full",placeholder:"0.00"},null,8,["modelValue"]),s(a).errors.amount?(i(),d("p",st,c(s(a).errors.amount),1)):A("",!0)]),e("div",at,[r(s(Q),{label:"Exchange",icon:"pi pi-sync",loading:s(a).processing,onClick:L},null,8,["loading"])])])]),_:1}),r(s(_),null,{title:u(()=>[...t[9]||(t[9]=[g("Quote",-1)])]),content:u(()=>{var o,p,m,y,f,E;return[l.value?(i(),d("div",ot,[e("div",rt,[t[10]||(t[10]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Rate",-1)),r(s(z),{severity:"info",value:`1 ${s(a).from_currency} = ${l.value.rate} ${s(a).to_currency}`},null,8,["value"])]),e("div",lt,[t[11]||(t[11]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Converted",-1)),e("span",nt,c(((p=(o=l.value.converted_amount)==null?void 0:o.toFixed)==null?void 0:p.call(o,2))??l.value.converted_amount),1)]),e("div",it,[t[12]||(t[12]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Fee (1%)",-1)),e("span",ct,c(((y=(m=l.value.fee)==null?void 0:m.toFixed)==null?void 0:y.call(m,2))??l.value.fee),1)]),r(s(J)),e("div",ut,[t[13]||(t[13]=e("span",{class:"font-semibold text-gray-900 dark:text-white"},"Total Received",-1)),e("span",dt,c(((E=(f=l.value.total)==null?void 0:f.toFixed)==null?void 0:E.call(f,2))??l.value.total)+" "+c(s(a).to_currency),1)])])):(i(),d("div",mt,[r(s(H),{severity:"secondary",closable:!1},{default:u(()=>[...t[14]||(t[14]=[g("Enter an amount to see a live quote.",-1)])]),_:1})]))]}),_:1})]),r(s(_),null,{title:u(()=>[...t[15]||(t[15]=[g("Available Rates",-1)])]),content:u(()=>[e("div",pt,[(i(!0),d(B,null,S(v.exchangeRates,(o,p)=>(i(),d("div",{key:p,class:"p-4 border rounded-xl dark:border-gray-700"},[e("p",yt,"Base: "+c(p),1),e("div",xt,[(i(!0),d(B,null,S(o,(m,y)=>(i(),d("div",{key:y,class:"flex justify-between"},[e("span",null,c(y),1),e("span",null,c(m),1)]))),128))])]))),128))])]),_:1})])]),_:1}))}};export{Nt as default};
