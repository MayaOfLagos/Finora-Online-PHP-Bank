import{k as R,f as L,c as _,o as w,d as o,u as a,m as B,w as r,a as t,t as d,h as E,b as S,j as V,i as g,e as I,F as T,p as Y}from"./app-CXBRDXRL.js";import{u as z}from"./useToast-C5Rq2I1M.js";import{a as v}from"./index-BY5Pvyke.js";import{s as M}from"./index-MXRsQvUz.js";import{s as O}from"./index-Y7Bu6IOH.js";import{s as G}from"./index-BE9ITL9W.js";import{s as H}from"./index-CdJ2HCMX.js";import{s as J,a as p}from"./index-CHIHkm-I.js";import{s as K}from"./index-BeqPdF04.js";import{s as Q}from"./index-2tTRG4qE.js";import{s as W}from"./index-Mu0dkGFt.js";import{c as X,D as Z}from"./DashboardLayout-DRnp4Kx-.js";import{u as P}from"./useCurrency-0zMdEeak.js";/* empty css            */import"./index-BIWAly7n.js";import"./index-CFg-6R1Q.js";import"./index-DGF8Thhm.js";import"./index-BdsEobEo.js";import"./index-CSA-oXeR.js";import"./index-D2R_SVcc.js";import"./index-DAuWDqao.js";import"./index-Ceb37f9X.js";import"./index-BGH3qnNr.js";import"./index-DTpTxaJD.js";import"./AppLogo-Ci3N4wRK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LiveChatWidget-BQDMi4wK.js";import"./PagePreloader-BDYRUMCs.js";import"./index-zwfbL8r3.js";const ee={class:"max-w-7xl mx-auto"},te={class:"flex flex-col gap-4 mb-6 sm:flex-row sm:items-center sm:justify-between"},ae={class:"text-center py-12"},se={class:"font-mono text-sm"},oe={class:"font-medium text-gray-900 dark:text-white"},le={class:"text-sm text-gray-500"},ne={class:"font-semibold text-gray-900 dark:text-white"},re={class:"text-sm text-gray-600 dark:text-gray-400"},ie={class:"text-sm"},de={class:"space-y-4"},ce={key:0,class:"flex items-center justify-between"},ue={class:"text-gray-500"},me={key:1},pe={class:"flex items-center justify-between py-2"},be={class:"font-medium"},ye={class:"text-sm text-gray-500"},fe={class:"text-right"},xe={class:"font-semibold"},we={key:0,class:"mt-1 text-xs text-gray-500"},ve={class:"mt-1 text-xs text-gray-500"},Ke={__name:"Index",props:{withdrawals:Object,bankAccounts:Array},setup($){const f=$,b=z(),D=R(),{formatCurrency:h}=P(),x=V(!1),u=V(!1),n=L({bank_account_id:null,amount:null,reason:""}),c=I(()=>f.bankAccounts.find(l=>l.id===n.bank_account_id)),U=l=>({pending:"warn",approved:"info",completed:"success",rejected:"danger",failed:"danger",cancelled:"secondary"})[l]||"secondary",j=l=>l.charAt(0).toUpperCase()+l.slice(1),k=()=>{var l;n.reset(),n.bank_account_id=(l=f.bankAccounts[0])==null?void 0:l.id,x.value=!0},F=()=>{var l;if(!n.bank_account_id||!n.amount){b.error("Please select an account and enter amount","Validation Error");return}if(n.amount>((l=c.value)==null?void 0:l.balance)/100){b.error("Withdrawal amount exceeds available balance","Insufficient Balance");return}u.value=!0,n.transform(e=>({...e,amount:Math.round((e.amount||0)*100)})).post(route("withdrawals.store"),{preserveScroll:!0,onSuccess:()=>{x.value=!1,n.reset(),b.success("Your withdrawal request has been submitted for approval","Withdrawal Requested")},onError:e=>{b.error(e.amount||e.error||"Unable to process withdrawal","Withdrawal Failed")},onFinish:()=>{u.value=!1}})},q=l=>{D.require({message:`Are you sure you want to cancel this withdrawal of ${h(l.amount,l.currency)}?`,header:"Cancel Withdrawal",icon:"pi pi-exclamation-triangle",acceptLabel:"Yes, Cancel",rejectLabel:"No",acceptClass:"p-button-danger",accept:()=>{Y.post(route("withdrawals.cancel",l.id),{},{preserveScroll:!0,onSuccess:()=>{b.success("Amount has been refunded to your account","Withdrawal Cancelled")},onError:e=>{b.error(e.error||"Unable to cancel withdrawal","Cancellation Failed")}})}})},N=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(l,e)=>(w(),_(T,null,[o(a(B),{title:"Withdrawals"}),o(Z,{title:"Withdrawals"},{default:r(()=>[o(a(X)),t("div",ee,[t("div",te,[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Withdrawals "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Request funds withdrawal to your external bank account ")],-1)),o(a(v),{label:"New Withdrawal",icon:"pi pi-plus",onClick:k,size:"large"})]),o(a(M),null,{content:r(()=>[o(a(J),{value:f.withdrawals.data,rows:20,paginator:f.withdrawals.data.length>0,responsiveLayout:"scroll",stripedRows:""},{empty:r(()=>[t("div",ae,[e[6]||(e[6]=t("i",{class:"pi pi-inbox text-6xl text-gray-300 dark:text-gray-600 mb-4"},null,-1)),e[7]||(e[7]=t("p",{class:"text-gray-500 dark:text-gray-400"},"No withdrawals yet",-1)),o(a(v),{label:"Make Your First Withdrawal",icon:"pi pi-plus",class:"mt-4",outlined:"",onClick:k})])]),default:r(()=>[o(a(p),{field:"reference_number",header:"Reference",style:{"min-width":"150px"}},{body:r(({data:s})=>[t("span",se,d(s.reference_number),1)]),_:1}),o(a(p),{field:"bank_account",header:"Account",style:{"min-width":"200px"}},{body:r(({data:s})=>{var y,i,m;return[t("div",null,[t("p",oe,d((i=(y=s.bank_account)==null?void 0:y.account_type)==null?void 0:i.name),1),t("p",le," ****"+d((m=s.bank_account)==null?void 0:m.account_number.slice(-4)),1)])]}),_:1}),o(a(p),{field:"amount",header:"Amount",style:{"min-width":"120px"}},{body:r(({data:s})=>[t("span",ne,d(a(h)(s.amount,s.currency)),1)]),_:1}),o(a(p),{field:"status",header:"Status",style:{"min-width":"120px"}},{body:r(({data:s})=>[o(a(K),{value:j(s.status),severity:U(s.status)},null,8,["value","severity"])]),_:1}),o(a(p),{field:"reason",header:"Reason",style:{"min-width":"200px"}},{body:r(({data:s})=>[t("span",re,d(s.reason||"-"),1)]),_:1}),o(a(p),{field:"created_at",header:"Date",style:{"min-width":"180px"}},{body:r(({data:s})=>[t("span",ie,d(N(s.created_at)),1)]),_:1}),o(a(p),{header:"Actions",style:{"min-width":"120px"}},{body:r(({data:s})=>[s.status==="pending"?(w(),E(a(v),{key:0,label:"Cancel",icon:"pi pi-times",severity:"danger",size:"small",outlined:"",onClick:y=>q(s)},null,8,["onClick"])):S("",!0)]),_:1})]),_:1},8,["value","paginator"])]),_:1})]),o(a(Q),{visible:x.value,"onUpdate:visible":e[4]||(e[4]=s=>x.value=s),modal:"",header:"New Withdrawal Request",style:{width:"600px"},closable:!u.value},{footer:r(()=>[o(a(v),{label:"Cancel",severity:"secondary",outlined:"",onClick:e[3]||(e[3]=s=>x.value=!1),disabled:u.value},null,8,["disabled"]),o(a(v),{label:"Submit Request",icon:"pi pi-check",onClick:F,loading:u.value,disabled:!a(n).bank_account_id||!a(n).amount},null,8,["loading","disabled"])]),default:r(()=>{var s,y;return[t("div",de,[o(a(W),{severity:"info",closable:!1},{default:r(()=>[...e[8]||(e[8]=[t("p",{class:"text-sm"}," Withdrawal requests require admin approval. Funds will be deducted from your account immediately and refunded if rejected. ",-1)])]),_:1}),t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},[g(" Withdraw From "),t("span",{class:"text-red-500"},"*")],-1)),o(a(H),{modelValue:a(n).bank_account_id,"onUpdate:modelValue":e[0]||(e[0]=i=>a(n).bank_account_id=i),options:f.bankAccounts,optionLabel:"account_type.name",optionValue:"id",placeholder:"Select Account",class:"w-full",disabled:u.value},{value:r(i=>{var m,C,A;return[i.value?(w(),_("div",ce,[t("span",null,d((C=(m=c.value)==null?void 0:m.account_type)==null?void 0:C.name),1),t("span",ue,"****"+d((A=c.value)==null?void 0:A.account_number.slice(-4)),1)])):(w(),_("span",me,d(i.placeholder),1))]}),option:r(i=>{var m;return[t("div",pe,[t("div",null,[t("div",be,d((m=i.option.account_type)==null?void 0:m.name),1),t("div",ye,"****"+d(i.option.account_number.slice(-4)),1)]),t("div",fe,[t("div",xe,d(a(h)(i.option.balance,i.option.currency)),1),e[9]||(e[9]=t("div",{class:"text-xs text-gray-500"},"Available",-1))])])]}),_:1},8,["modelValue","options","disabled"]),c.value?(w(),_("p",we," Available Balance: "+d(a(h)(c.value.balance,c.value.currency)),1)):S("",!0)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},[g(" Amount "),t("span",{class:"text-red-500"},"*")],-1)),o(a(O),{modelValue:a(n).amount,"onUpdate:modelValue":e[1]||(e[1]=i=>a(n).amount=i),mode:"currency",currency:((s=c.value)==null?void 0:s.currency)||"USD",locale:"en-US",placeholder:"0.00",class:"w-full",min:1,max:c.value?c.value.balance/100:void 0,disabled:!a(n).bank_account_id||u.value},null,8,["modelValue","currency","max","disabled"]),e[12]||(e[12]=t("p",{class:"mt-1 text-xs text-gray-500"}," Enter the amount you want to withdraw ",-1))]),t("div",null,[e[13]||(e[13]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Reason (Optional) ",-1)),o(a(G),{modelValue:a(n).reason,"onUpdate:modelValue":e[2]||(e[2]=i=>a(n).reason=i),rows:"3",placeholder:"e.g., Personal expenses, Emergency...",class:"w-full",maxlength:"500",disabled:u.value},null,8,["modelValue","disabled"]),t("p",ve,d(((y=a(n).reason)==null?void 0:y.length)||0)+"/500 characters ",1)]),o(a(W),{severity:"warn",closable:!1},{default:r(()=>[...e[14]||(e[14]=[t("p",{class:"text-sm"},[t("strong",null,"Important:"),g(" The amount will be deducted immediately. If your withdrawal is rejected, it will be refunded to your account. ")],-1)])]),_:1})])]}),_:1},8,["visible","closable"])]),_:1})],64))}};export{Ke as default};
