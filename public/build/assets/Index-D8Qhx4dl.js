import{f as S,e as N,A as T,h as M,o as i,w as u,a as e,d as r,u as s,c as d,b as E,t as c,i as g,j as U,F as B,r as D,a0 as O}from"./app-pKJNfMRl.js";import{D as q}from"./DashboardLayout-DUkHFthn.js";import{s as _}from"./index-OLDQvyIc.js";import{s as b}from"./index-ChsDMTvI.js";import{s as I}from"./index-CtUoG6pH.js";import{a as Q}from"./index-0Wu5cDGM.js";import{s as z}from"./index--xZ2gyYE.js";import{s as G}from"./index-KeYFm4k9.js";import{s as H}from"./index-BRS6OGoc.js";import{u as J}from"./useToast-Clsx83_F.js";/* empty css            */import"./index-C_ADElv8.js";import"./index-DPCvanh-.js";import"./index-C89qVnDF.js";import"./index-CfAZwmyf.js";import"./index-CNg3KC2i.js";import"./AppLogo-BTsSFa4-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LiveChatWidget-BXRvd797.js";import"./index-D9m-7Ja_.js";import"./index-Ck0rIvtu.js";import"./index-gutiSzhf.js";import"./index-BkMBywhY.js";const K={class:"space-y-6"},P={class:"grid gap-6 lg:grid-cols-3"},W={class:"grid gap-4 md:grid-cols-2"},X={class:"space-y-1 md:col-span-2"},Y={key:0,class:"text-sm text-red-500"},Z={class:"space-y-1"},tt={class:"space-y-1"},et={class:"space-y-1 md:col-span-2"},st={key:0,class:"text-sm text-red-500"},ot={class:"md:col-span-2 flex justify-end"},at={key:0,class:"space-y-3"},rt={class:"flex items-center justify-between"},lt={class:"flex items-center justify-between"},nt={class:"text-lg font-semibold text-gray-900 dark:text-white"},it={class:"flex items-center justify-between"},ct={class:"text-gray-900 dark:text-white"},ut={class:"flex items-center justify-between"},dt={class:"text-xl font-bold text-emerald-600"},mt={key:1,class:"space-y-2"},pt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},yt={class:"text-sm font-semibold text-gray-900 dark:text-white"},xt={class:"mt-2 space-y-1 text-sm text-gray-700 dark:text-gray-300"},Ot={__name:"Index",props:{bankAccounts:{type:Array,default:()=>[]},exchangeRates:{type:Object,default:()=>({})}},setup(v){var h,F,R,j,$,A;const k=v,w=J(),x=N(()=>Object.keys(k.exchangeRates).map(n=>({label:n,value:n}))),o=S({bank_account_id:((F=(h=k.bankAccounts)==null?void 0:h[0])==null?void 0:F.id)??null,from_currency:((j=(R=x.value)==null?void 0:R[0])==null?void 0:j.value)??"USD",to_currency:((A=($=x.value)==null?void 0:$[1])==null?void 0:A.value)??"EUR",amount:100}),l=U(null),V=U(!1);T(()=>[o.from_currency,o.to_currency,o.amount],async()=>{var n,t;if(!(!o.from_currency||!o.to_currency||!o.amount)){V.value=!0;try{const{data:a}=await O.post("/exchange/rate",{from_currency:o.from_currency,to_currency:o.to_currency,amount:o.amount});l.value=a}catch(a){w.error(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||"Could not fetch rate.","Rate unavailable")}finally{V.value=!1}}},{immediate:!0});const L=()=>{o.transform(n=>({...n,amount:Math.round((n.amount||0)*100)})).post("/exchange",{preserveScroll:!0,onSuccess:()=>w.success("Currency converted.","Exchanged")})};return(n,t)=>(i(),M(q,{title:"Exchange Money"},{default:u(()=>[e("div",K,[t[16]||(t[16]=e("div",{class:"flex flex-col gap-2"},[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Exchange Money"),e("p",{class:"text-gray-600 dark:text-gray-400"},"Convert between currencies using your Finora accounts.")],-1)),e("div",P,[r(s(_),{class:"lg:col-span-2"},{title:u(()=>[...t[4]||(t[4]=[g("Conversion",-1)])]),content:u(()=>[e("div",W,[e("div",X,[t[5]||(t[5]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From Account",-1)),r(s(b),{modelValue:s(o).bank_account_id,"onUpdate:modelValue":t[0]||(t[0]=a=>s(o).bank_account_id=a),options:v.bankAccounts,optionLabel:"account_number",optionValue:"id",class:"w-full",placeholder:"Select account"},null,8,["modelValue","options"]),s(o).errors.bank_account_id?(i(),d("p",Y,c(s(o).errors.bank_account_id),1)):E("",!0)]),e("div",Z,[t[6]||(t[6]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"From",-1)),r(s(b),{modelValue:s(o).from_currency,"onUpdate:modelValue":t[1]||(t[1]=a=>s(o).from_currency=a),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),e("div",tt,[t[7]||(t[7]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"To",-1)),r(s(b),{modelValue:s(o).to_currency,"onUpdate:modelValue":t[2]||(t[2]=a=>s(o).to_currency=a),options:x.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),e("div",et,[t[8]||(t[8]=e("label",{class:"text-sm text-gray-700 dark:text-gray-300"},"Amount",-1)),r(s(I),{modelValue:s(o).amount,"onUpdate:modelValue":t[3]||(t[3]=a=>s(o).amount=a),mode:"decimal",min:1,maxFractionDigits:2,class:"w-full",placeholder:"0.00"},null,8,["modelValue"]),s(o).errors.amount?(i(),d("p",st,c(s(o).errors.amount),1)):E("",!0)]),e("div",ot,[r(s(Q),{label:"Exchange",icon:"pi pi-sync",loading:s(o).processing,onClick:L},null,8,["loading"])])])]),_:1}),r(s(_),null,{title:u(()=>[...t[9]||(t[9]=[g("Quote",-1)])]),content:u(()=>{var a,p,m,y,f,C;return[l.value?(i(),d("div",at,[e("div",rt,[t[10]||(t[10]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Rate",-1)),r(s(z),{severity:"info",value:`1 ${s(o).from_currency} = ${l.value.rate} ${s(o).to_currency}`},null,8,["value"])]),e("div",lt,[t[11]||(t[11]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Converted",-1)),e("span",nt,c(((p=(a=l.value.converted_amount)==null?void 0:a.toFixed)==null?void 0:p.call(a,2))??l.value.converted_amount),1)]),e("div",it,[t[12]||(t[12]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Fee (1%)",-1)),e("span",ct,c(((y=(m=l.value.fee)==null?void 0:m.toFixed)==null?void 0:y.call(m,2))??l.value.fee),1)]),r(s(H)),e("div",ut,[t[13]||(t[13]=e("span",{class:"font-semibold text-gray-900 dark:text-white"},"Total Received",-1)),e("span",dt,c(((C=(f=l.value.total)==null?void 0:f.toFixed)==null?void 0:C.call(f,2))??l.value.total)+" "+c(s(o).to_currency),1)])])):(i(),d("div",mt,[r(s(G),{severity:"secondary",closable:!1},{default:u(()=>[...t[14]||(t[14]=[g("Enter an amount to see a live quote.",-1)])]),_:1})]))]}),_:1})]),r(s(_),null,{title:u(()=>[...t[15]||(t[15]=[g("Available Rates",-1)])]),content:u(()=>[e("div",pt,[(i(!0),d(B,null,D(v.exchangeRates,(a,p)=>(i(),d("div",{key:p,class:"p-4 border rounded-xl dark:border-gray-700"},[e("p",yt,"Base: "+c(p),1),e("div",xt,[(i(!0),d(B,null,D(a,(m,y)=>(i(),d("div",{key:y,class:"flex justify-between"},[e("span",null,c(y),1),e("span",null,c(m),1)]))),128))])]))),128))])]),_:1})])]),_:1}))}};export{Ot as default};
