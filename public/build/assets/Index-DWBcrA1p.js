import{k as te,l as se,f as F,c as m,d as l,u as s,p as re,w as b,a as e,b as p,j as k,t as o,o as u,F as P,r as ie,e as le,h as ae,i as R,q as O}from"./app-gzwEpnaP.js";import{a as f}from"./index-C6Yod2zr.js";import{s as E}from"./index-DVy9051S.js";import{s as oe,a as ne}from"./index-C3IFdXfx.js";import{s as M}from"./index-BBmRBaSt.js";import{s as de}from"./index-DNsLqaKo.js";import{s as ue,D as ce}from"./DashboardLayout-CiwfOeQ7.js";import{s as me}from"./index-DXKIm9nL.js";import{_ as Q}from"./PinInput-Bj-GXPAW.js";import{u as fe}from"./useCurrency-0zMdEeak.js";/* empty css            */import"./index-FoahLAXE.js";import"./index-BOym-t3Z.js";import"./index-fks0jdkX.js";import"./AppLogo-BjOaTnmJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CFHVGFVi.js";const pe={class:"space-y-6"},ge={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},be={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},xe={class:"p-5 bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700 shadow-sm border-l-4 border-l-indigo-500"},ye={class:"flex items-center justify-between"},ve={class:"mt-1 text-3xl font-bold text-gray-900 dark:text-white"},ke={class:"p-5 bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700 shadow-sm border-l-4 border-l-green-500"},_e={class:"flex items-center justify-between"},we={class:"mt-1 text-3xl font-bold text-gray-900 dark:text-white"},he={class:"p-5 bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700 shadow-sm border-l-4 border-l-amber-500"},Ve={class:"flex items-center justify-between"},Ce={class:"mt-1 text-3xl font-bold text-gray-900 dark:text-white"},je={class:"flex flex-col gap-4 md:flex-row md:items-center"},Ae={class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},Se={class:"p-5"},Be={class:"flex items-start justify-between mb-4"},Ee={class:"flex items-center gap-3"},Ue={class:"flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold text-lg"},Ne={class:"font-semibold text-gray-900 dark:text-white"},Te={class:"text-sm text-gray-500 dark:text-gray-400"},$e={class:"flex items-center gap-2"},Fe={key:0,class:"pi pi-star-fill text-amber-500",title:"Favorite"},Me={class:"space-y-3"},De={class:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-700"},Le={class:"font-mono text-sm font-medium text-gray-900 dark:text-white"},qe={class:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-700"},He={class:"text-sm font-medium text-gray-900 dark:text-white"},Ie={key:0,class:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-700"},Pe={class:"text-sm font-medium text-gray-900 dark:text-white"},Re={key:1,class:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-700"},Oe={class:"text-sm text-gray-900 dark:text-white"},Qe={class:"flex gap-2 mt-4"},Je={class:"px-5 py-4 bg-gray-50 dark:bg-gray-700/50"},Xe={key:0,class:"flex flex-col items-center justify-center py-16 text-center"},Ye={class:"text-lg font-semibold text-gray-900 dark:text-white"},ze={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Ge={class:"space-y-4"},We={class:"flex gap-2"},Ke={key:0,class:"mt-1 text-sm text-red-600"},Ze={key:0,class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800"},et={class:"flex items-center gap-3"},tt={class:"font-semibold text-green-800 dark:text-green-200"},st={class:"text-sm text-green-600 dark:text-green-400"},rt={key:0,class:"mt-1 text-sm text-red-600"},it={class:"flex justify-end gap-2"},lt={class:"space-y-4"},at={class:"flex justify-end gap-2"},ot={class:"space-y-4"},nt={class:"text-gray-600 dark:text-gray-400"},dt={key:0,class:"mt-1 text-sm text-red-600"},ut={class:"flex justify-end gap-2"},St={__name:"Index",props:{beneficiaries:{type:Array,default:()=>[]},stats:{type:Object,default:()=>({})}},setup(A){const D=A,c=te();se();const{formatCurrency:J}=fe(),x=k(""),_=k(!1),S=k(!1),B=k(!1),y=k(null),U=k(!1),g=k(null),a=F({account_number:"",nickname:"",pin:""}),n=F({nickname:"",is_favorite:!1,transfer_limit:null}),d=F({pin:""}),L=le(()=>{if(!x.value)return D.beneficiaries;const i=x.value.toLowerCase();return D.beneficiaries.filter(t=>{var r,v,w,h,V,C,j;return((r=t.nickname)==null?void 0:r.toLowerCase().includes(i))||((w=(v=t.beneficiary_account)==null?void 0:v.account_number)==null?void 0:w.includes(i))||((V=(h=t.beneficiary_user)==null?void 0:h.name)==null?void 0:V.toLowerCase().includes(i))||((j=(C=t.beneficiary_user)==null?void 0:C.email)==null?void 0:j.toLowerCase().includes(i))})}),X=async()=>{if(!a.account_number||a.account_number.length<10){c.add({severity:"warn",summary:"Invalid",detail:"Please enter a valid account number",life:3e3});return}U.value=!0,g.value=null;try{const i=await fetch(route("api.accounts.verify",{accountNumber:a.account_number}),{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const t=await i.json();t.success&&t.recipient?(g.value={account_name:t.recipient.name,account_type:t.recipient.account_type},c.add({severity:"success",summary:"Account Found",detail:`Account holder: ${t.recipient.name}`,life:3e3})):c.add({severity:"error",summary:"Not Found",detail:t.message||"No account found with this number",life:3e3})}catch(i){console.error("Verify account error:",i),c.add({severity:"error",summary:"Error",detail:"Failed to verify account",life:3e3})}finally{U.value=!1}},Y=()=>{if(!g.value){c.add({severity:"warn",summary:"Verify Account",detail:"Please verify the account number first",life:3e3});return}a.post(route("beneficiaries.store"),{preserveScroll:!0,onSuccess:()=>{c.add({severity:"success",summary:"Success",detail:"Beneficiary added successfully",life:3e3}),N()},onError:i=>{i.pin&&c.add({severity:"error",summary:"Error",detail:i.pin,life:3e3})}})},z=i=>{y.value=i,n.nickname=i.nickname||"",n.is_favorite=i.is_favorite||!1,n.transfer_limit=i.transfer_limit?i.transfer_limit/100:null,S.value=!0},G=()=>{n.transform(i=>({...i,transfer_limit:i.transfer_limit?i.transfer_limit*100:null})).patch(route("beneficiaries.update",{beneficiary:y.value.uuid}),{preserveScroll:!0,onSuccess:()=>{c.add({severity:"success",summary:"Success",detail:"Beneficiary updated successfully",life:3e3}),T()}})},W=i=>{O.patch(route("beneficiaries.toggle-favorite",{beneficiary:i.uuid}),{},{preserveScroll:!0,onSuccess:()=>{c.add({severity:"success",summary:"Success",detail:i.is_favorite?"Removed from favorites":"Added to favorites",life:3e3})}})},K=i=>{y.value=i,d.reset(),B.value=!0},Z=()=>{d.delete(route("beneficiaries.destroy",{beneficiary:y.value.uuid}),{preserveScroll:!0,onSuccess:()=>{c.add({severity:"success",summary:"Success",detail:"Beneficiary deleted successfully",life:3e3}),$()},onError:i=>{i.pin&&c.add({severity:"error",summary:"Error",detail:i.pin,life:3e3})}})},q=i=>{O.visit(route("transfers.internal"),{data:{beneficiary:i.uuid}})},N=()=>{_.value=!1,a.reset(),g.value=null},T=()=>{S.value=!1,y.value=null,n.reset()},$=()=>{B.value=!1,y.value=null,d.reset()},ee=i=>[{label:"Quick Transfer",icon:"pi pi-send",command:()=>q(i)},{label:"Edit",icon:"pi pi-pencil",command:()=>z(i)},{label:i.is_favorite?"Remove from Favorites":"Add to Favorites",icon:i.is_favorite?"pi pi-star":"pi pi-star-fill",command:()=>W(i)},{separator:!0},{label:"Delete",icon:"pi pi-trash",class:"text-red-600",command:()=>K(i)}];return(i,t)=>(u(),m(P,null,[l(s(re),{title:"Beneficiaries"}),l(ce,null,{default:b(()=>[e("div",pe,[e("div",ge,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Beneficiaries "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Manage your saved beneficiaries for quick transfers ")],-1)),l(s(f),{label:"Add Beneficiary",icon:"pi pi-plus",onClick:t[0]||(t[0]=r=>_.value=!0)})]),e("div",be,[e("div",xe,[e("div",ye,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Total Beneficiaries",-1)),e("p",ve,o(A.stats.total_beneficiaries||0),1)]),t[14]||(t[14]=e("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30"},[e("i",{class:"pi pi-users text-xl text-indigo-600 dark:text-indigo-400"})],-1))])]),e("div",ke,[e("div",_e,[e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Verified",-1)),e("p",we,o(A.stats.verified_beneficiaries||0),1)]),t[16]||(t[16]=e("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30"},[e("i",{class:"pi pi-check-circle text-xl text-green-600 dark:text-green-400"})],-1))])]),e("div",he,[e("div",Ve,[e("div",null,[t[17]||(t[17]=e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Favorites",-1)),e("p",Ce,o(A.stats.favorite_beneficiaries||0),1)]),t[18]||(t[18]=e("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-amber-100 dark:bg-amber-900/30"},[e("i",{class:"pi pi-star-fill text-xl text-amber-600 dark:text-amber-400"})],-1))])])]),e("div",je,[l(s(oe),{class:"w-full md:w-80"},{default:b(()=>[l(s(ne),{class:"pi pi-search"}),l(s(E),{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=r=>x.value=r),placeholder:"Search beneficiaries...",class:"w-full"},null,8,["modelValue"])]),_:1})]),e("div",Ae,[(u(!0),m(P,null,ie(L.value,r=>{var v,w,h,V,C,j,H;return u(),m("div",{key:r.uuid,class:"overflow-hidden bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700 shadow-sm hover:shadow-lg transition-all duration-300"},[e("div",Se,[e("div",Be,[e("div",Ee,[e("div",Ue,o((((v=r.beneficiary_user)==null?void 0:v.name)||r.nickname||"B").charAt(0).toUpperCase()),1),e("div",null,[e("h3",Ne,o(r.nickname||((w=r.beneficiary_user)==null?void 0:w.name)||"Unknown"),1),e("p",Te,o(((h=r.beneficiary_user)==null?void 0:h.email)||""),1)])]),e("div",$e,[r.is_favorite?(u(),m("i",Fe)):p("",!0),l(s(f),{icon:"pi pi-ellipsis-v",text:"",rounded:"",size:"small",onClick:I=>i.$refs[`menu_${r.uuid}`][0].toggle(I)},null,8,["onClick"]),l(s(ue),{ref_for:!0,ref:`menu_${r.uuid}`,model:ee(r),popup:""},null,8,["model"])])]),e("div",Me,[e("div",De,[t[19]||(t[19]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Account Number",-1)),e("span",Le," ****"+o(((C=(V=r.beneficiary_account)==null?void 0:V.account_number)==null?void 0:C.slice(-4))||"****"),1)]),e("div",qe,[t[20]||(t[20]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Account Type",-1)),e("span",He,o(((j=r.beneficiary_account)==null?void 0:j.account_type)||"Savings"),1)]),r.transfer_limit?(u(),m("div",Ie,[t[21]||(t[21]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Transfer Limit",-1)),e("span",Pe,o(s(J)(r.transfer_limit,((H=r.beneficiary_account)==null?void 0:H.currency)||"USD")),1)])):p("",!0),r.last_used_at?(u(),m("div",Re,[t[22]||(t[22]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Last Used",-1)),e("span",Oe,o(r.last_used_at_human),1)])):p("",!0)]),e("div",Qe,[l(s(de),{value:r.is_verified?"Verified":"Unverified",severity:r.is_verified?"success":"warning",class:"text-xs"},null,8,["value","severity"])])]),e("div",Je,[l(s(f),{label:"Quick Transfer",icon:"pi pi-send",class:"w-full",onClick:I=>q(r)},null,8,["onClick"])])])}),128))]),L.value.length===0?(u(),m("div",Xe,[t[23]||(t[23]=e("div",{class:"flex items-center justify-center w-20 h-20 mb-4 rounded-full bg-gray-100 dark:bg-gray-800"},[e("i",{class:"pi pi-users text-3xl text-gray-400"})],-1)),e("h3",Ye,o(x.value?"No beneficiaries found":"No beneficiaries yet"),1),e("p",ze,o(x.value?"Try adjusting your search":"Add beneficiaries for quick transfers"),1),x.value?p("",!0):(u(),ae(s(f),{key:0,label:"Add Your First Beneficiary",icon:"pi pi-plus",class:"mt-4",onClick:t[2]||(t[2]=r=>_.value=!0)}))])):p("",!0)]),l(s(M),{visible:_.value,"onUpdate:visible":t[6]||(t[6]=r=>_.value=r),modal:"",header:"Add Beneficiary",style:{width:"450px"},closable:!s(a).processing,onHide:N},{footer:b(()=>[e("div",it,[l(s(f),{label:"Cancel",outlined:"",disabled:s(a).processing,onClick:N},null,8,["disabled"]),l(s(f),{label:"Add Beneficiary",icon:"pi pi-plus",loading:s(a).processing,disabled:!g.value||!s(a).pin,onClick:Y},null,8,["loading","disabled"])])]),default:b(()=>[e("div",Ge,[e("div",null,[t[24]||(t[24]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Account Number ",-1)),e("div",We,[l(s(E),{modelValue:s(a).account_number,"onUpdate:modelValue":t[3]||(t[3]=r=>s(a).account_number=r),placeholder:"Enter account number",class:"flex-1",disabled:s(a).processing},null,8,["modelValue","disabled"]),l(s(f),{icon:"pi pi-search",loading:U.value,onClick:X},null,8,["loading"])]),s(a).errors.account_number?(u(),m("p",Ke,o(s(a).errors.account_number),1)):p("",!0)]),g.value?(u(),m("div",Ze,[e("div",et,[t[25]||(t[25]=e("div",{class:"flex items-center justify-center w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30"},[e("i",{class:"pi pi-check text-green-600"})],-1)),e("div",null,[e("p",tt,o(g.value.account_name),1),e("p",st,o(g.value.account_type)+" - Account verified ",1)])])])):p("",!0),e("div",null,[t[26]||(t[26]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Nickname (Optional) ",-1)),l(s(E),{modelValue:s(a).nickname,"onUpdate:modelValue":t[4]||(t[4]=r=>s(a).nickname=r),placeholder:"E.g., Mom, John's Account",class:"w-full",disabled:s(a).processing},null,8,["modelValue","disabled"])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Transaction PIN ",-1)),l(Q,{modelValue:s(a).pin,"onUpdate:modelValue":t[5]||(t[5]=r=>s(a).pin=r),length:6,masked:"",disabled:s(a).processing},null,8,["modelValue","disabled"]),s(a).errors.pin?(u(),m("p",rt,o(s(a).errors.pin),1)):p("",!0)])])]),_:1},8,["visible","closable"]),l(s(M),{visible:S.value,"onUpdate:visible":t[9]||(t[9]=r=>S.value=r),modal:"",header:"Edit Beneficiary",style:{width:"450px"},closable:!s(n).processing,onHide:T},{footer:b(()=>[e("div",at,[l(s(f),{label:"Cancel",outlined:"",disabled:s(n).processing,onClick:T},null,8,["disabled"]),l(s(f),{label:"Save Changes",icon:"pi pi-check",loading:s(n).processing,onClick:G},null,8,["loading"])])]),default:b(()=>[e("div",lt,[e("div",null,[t[28]||(t[28]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Nickname ",-1)),l(s(E),{modelValue:s(n).nickname,"onUpdate:modelValue":t[7]||(t[7]=r=>s(n).nickname=r),placeholder:"E.g., Mom, John's Account",class:"w-full",disabled:s(n).processing},null,8,["modelValue","disabled"])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Transfer Limit (Optional) ",-1)),l(s(me),{modelValue:s(n).transfer_limit,"onUpdate:modelValue":t[8]||(t[8]=r=>s(n).transfer_limit=r),mode:"currency",currency:"USD",locale:"en-US",placeholder:"No limit",class:"w-full",disabled:s(n).processing},null,8,["modelValue","disabled"]),t[30]||(t[30]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Set a maximum transfer amount for this beneficiary ",-1))])])]),_:1},8,["visible","closable"]),l(s(M),{visible:B.value,"onUpdate:visible":t[11]||(t[11]=r=>B.value=r),modal:"",header:"Delete Beneficiary",style:{width:"400px"},closable:!s(d).processing,onHide:$},{footer:b(()=>[e("div",ut,[l(s(f),{label:"Cancel",outlined:"",disabled:s(d).processing,onClick:$},null,8,["disabled"]),l(s(f),{label:"Delete",icon:"pi pi-trash",severity:"danger",loading:s(d).processing,disabled:!s(d).pin,onClick:Z},null,8,["loading","disabled"])])]),default:b(()=>{var r;return[e("div",ot,[t[34]||(t[34]=e("div",{class:"flex items-center gap-4 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg"},[e("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30"},[e("i",{class:"pi pi-exclamation-triangle text-2xl text-red-600"})]),e("div",null,[e("p",{class:"font-semibold text-red-800 dark:text-red-200"}," Are you sure? "),e("p",{class:"text-sm text-red-600 dark:text-red-400"}," This action cannot be undone. ")])],-1)),e("p",nt,[t[31]||(t[31]=R(" You are about to delete ",-1)),e("strong",null,o(((r=y.value)==null?void 0:r.nickname)||"this beneficiary"),1),t[32]||(t[32]=R(". ",-1))]),e("div",null,[t[33]||(t[33]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Enter Transaction PIN to confirm ",-1)),l(Q,{modelValue:s(d).pin,"onUpdate:modelValue":t[10]||(t[10]=v=>s(d).pin=v),length:6,masked:"",disabled:s(d).processing},null,8,["modelValue","disabled"]),s(d).errors.pin?(u(),m("p",dt,o(s(d).errors.pin),1)):p("",!0)])])]}),_:1},8,["visible","closable"])]),_:1})],64))}};export{St as default};
