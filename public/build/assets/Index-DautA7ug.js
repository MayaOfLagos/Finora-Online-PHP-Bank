import{k as H,e as u,f as J,h as L,w as n,a as t,d as i,t as l,u as s,b as m,o as r,i as w,c,n as T,F as Q,r as X,j as V,x as Z,A as tt}from"./app-DY7F4LNy.js";import{D as et}from"./DashboardLayout-EIdcueOb.js";import{s as C}from"./index-CPOBudbM.js";import{a as k}from"./index-Q46qLhaw.js";import{s as st}from"./index-DUzdF6Vt.js";import{s as at}from"./index-CG9gcjqp.js";import{s as D}from"./index-CEB9g7h0.js";import{s as ot}from"./index-B8W3NMkv.js";import{s as F}from"./index-DFUxBtsw.js";import{s as lt}from"./index-Dby1x602.js";import{s as U}from"./index-Cftx6ogL.js";import{s as I}from"./index-DCELDH_O.js";/* empty css            */import"./index-geLy6D3S.js";import"./index-DKOwEOSs.js";import"./index-Ct6nfjLm.js";import"./index-2gKaEIju.js";import"./index-CJDaQd8m.js";import"./AppLogo-PcFzQ9wQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CsXDJqqB.js";import"./index-m_rPIY9a.js";const it={class:"space-y-6"},nt={class:"space-y-1"},rt={class:"text-gray-600 dark:text-gray-400"},dt={class:"grid gap-4 md:grid-cols-4"},ct={class:"p-4 bg-gradient-to-br from-green-500 to-green-600 rounded-xl text-white"},pt={class:"text-3xl font-bold"},ut={class:"text-xs mt-1 opacity-70"},mt={class:"p-4 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl text-white"},xt={class:"text-3xl font-bold"},yt={class:"p-4 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl text-white"},ft={class:"text-3xl font-bold"},gt={class:"p-4 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl text-white"},vt={class:"text-3xl font-bold"},bt={class:"grid gap-6 lg:grid-cols-3"},_t={class:"grid gap-4 md:grid-cols-2"},kt={class:"text-xs text-gray-500 mt-1"},ht={key:0,class:"text-sm text-red-500 mt-1"},wt={class:"flex items-center gap-2"},Vt={key:0,class:"text-sm text-red-500 mt-1"},Ct={key:0,class:"md:col-span-2"},Pt={class:"flex justify-between items-center w-full"},jt={class:"text-gray-500 text-sm"},Rt={key:0},St={key:1,class:"text-gray-400"},$t={key:0,class:"text-sm text-red-500 mt-1"},At={class:"md:col-span-2 flex justify-end"},Et={class:"space-y-4"},Nt={class:"text-center"},Lt={class:"text-4xl font-bold text-primary"},Tt={class:"flex justify-between text-xs text-gray-500"},Dt={key:0,class:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},Ft={class:"flex items-center justify-between"},Ut={class:"font-semibold text-gray-900 dark:text-white truncate"},It={class:"flex items-center gap-2"},Mt={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},Bt={class:"text-xs text-gray-500"},Ot={class:"text-xs text-gray-400"},Yt={key:1,class:"text-center py-8"},Kt={class:"space-y-4"},qt={class:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 space-y-2"},zt={class:"flex justify-between"},Wt={class:"font-bold text-gray-900 dark:text-white"},Gt={class:"flex justify-between"},Ht={class:"font-bold text-green-600"},Jt={class:"flex justify-between"},Qt={class:"font-medium text-gray-900 dark:text-white"},Xt={key:0,class:"flex justify-between"},Zt={class:"font-medium text-gray-900 dark:text-white"},te={class:"flex justify-end gap-2"},ee={class:"space-y-4"},se={class:"flex flex-col items-center gap-2"},ae={key:0,class:"text-sm text-red-500"},oe={class:"flex justify-end gap-2"},je={__name:"Index",props:{rewards:{type:Object,default:()=>({data:[]})},stats:{type:Object,default:()=>({})},bankAccounts:{type:Array,default:()=>[]}},setup(f){var A,E,N;const g=f,M=tt(),P=u(()=>M.props.flash),B=H();(A=P.value)!=null&&A.success&&B.add({severity:"success",summary:"Success",detail:P.value.success,life:4e3});const a=J({points:100,redemption_type:"cash",bank_account_id:((N=(E=g.bankAccounts)==null?void 0:E[0])==null?void 0:N.id)??null,pin:""}),j=[{label:"Cash (Credit to Account)",value:"cash",icon:"pi pi-wallet"},{label:"Voucher Code",value:"voucher",icon:"pi pi-ticket"},{label:"Discount on Services",value:"discount",icon:"pi pi-percentage"}],v=V(!1),x=V(!1),y=V(!1),h=u(()=>g.stats.total_earned??0),O=u(()=>g.stats.total_redeemed??0),d=u(()=>g.stats.available??0),Y=u(()=>h.value?Math.min(d.value/h.value*100,100):0),R=u(()=>(a.points/100).toFixed(2)),b=u(()=>g.bankAccounts.find(p=>p.id===a.bank_account_id)),K=u(()=>j.find(p=>p.value===a.redemption_type)),q=p=>({earned:"success",redeemed:"info",pending:"warn",expired:"danger"})[p]||"secondary",z=()=>{if(a.points<100){a.setError("points","Minimum 100 points required");return}if(a.points>d.value){a.setError("points",`You only have ${d.value} points available`);return}if(a.redemption_type==="cash"&&!a.bank_account_id){a.setError("bank_account_id","Please select an account for cash redemption");return}a.clearErrors(),v.value=!0},W=()=>{v.value=!1,a.pin="",x.value=!0},S=()=>{if(a.pin.length!==6){a.setError("pin","PIN must be 6 digits");return}y.value=!0,a.post("/rewards/redeem",{preserveScroll:!0,onSuccess:()=>{x.value=!1,a.reset("points","pin"),a.points=100},onError:p=>{p.pin||(x.value=!1)},onFinish:()=>{y.value=!1}})},$=()=>{v.value=!1,x.value=!1,a.pin=""},G=p=>p?new Date(p).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A";return(p,e)=>(r(),L(et,{title:"Rewards"},{default:n(()=>[t("div",it,[t("div",nt,[e[6]||(e[6]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Rewards",-1)),t("p",rt,"Earn and redeem points across "+l(p.$page.props.appName||"Finora")+" experiences.",1)]),t("div",dt,[t("div",ct,[e[7]||(e[7]=t("p",{class:"text-sm opacity-80"},"Available Points",-1)),t("p",pt,l(d.value.toLocaleString()),1),t("p",ut,"â‰ˆ $"+l((d.value/100).toFixed(2))+" value",1)]),t("div",mt,[e[8]||(e[8]=t("p",{class:"text-sm opacity-80"},"Total Earned",-1)),t("p",xt,l(h.value.toLocaleString()),1)]),t("div",yt,[e[9]||(e[9]=t("p",{class:"text-sm opacity-80"},"Total Redeemed",-1)),t("p",ft,l(O.value.toLocaleString()),1)]),t("div",gt,[e[10]||(e[10]=t("p",{class:"text-sm opacity-80"},"Pending",-1)),t("p",vt,l(f.stats.pending??0),1)])]),t("div",bt,[i(s(C),{class:"lg:col-span-2"},{title:n(()=>[...e[11]||(e[11]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-gift text-primary"}),w(" Redeem Points ")],-1)])]),content:n(()=>[d.value<100?(r(),L(s(I),{key:0,severity:"warn",closable:!1,class:"mb-4"},{default:n(()=>[...e[12]||(e[12]=[w(" You need at least 100 points to redeem. Keep earning! ",-1)])]),_:1})):m("",!0),t("div",_t,[t("div",null,[e[13]||(e[13]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Points to Redeem",-1)),i(s(at),{modelValue:s(a).points,"onUpdate:modelValue":e[0]||(e[0]=o=>s(a).points=o),min:100,max:d.value,step:50,class:"w-full mt-1",disabled:d.value<100},null,8,["modelValue","max","disabled"]),t("p",kt,"Cash value: $"+l(R.value),1),s(a).errors.points?(r(),c("p",ht,l(s(a).errors.points),1)):m("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Redemption Type",-1)),i(s(D),{modelValue:s(a).redemption_type,"onUpdate:modelValue":e[1]||(e[1]=o=>s(a).redemption_type=o),options:j,optionLabel:"label",optionValue:"value",class:"w-full mt-1",disabled:d.value<100},{option:n(({option:o})=>[t("div",wt,[t("i",{class:T(o.icon)},null,2),t("span",null,l(o.label),1)])]),_:1},8,["modelValue","disabled"]),s(a).errors.redemption_type?(r(),c("p",Vt,l(s(a).errors.redemption_type),1)):m("",!0)]),s(a).redemption_type==="cash"?(r(),c("div",Ct,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Credit to Account",-1)),i(s(D),{modelValue:s(a).bank_account_id,"onUpdate:modelValue":e[2]||(e[2]=o=>s(a).bank_account_id=o),options:f.bankAccounts,optionLabel:"account_name",optionValue:"id",class:"w-full mt-1",placeholder:"Select account",disabled:d.value<100},{option:n(({option:o})=>{var _;return[t("div",Pt,[t("span",null,l(o.account_name),1),t("span",jt,"****"+l((_=o.account_number)==null?void 0:_.slice(-4)),1)])]}),value:n(({value:o})=>{var _;return[b.value?(r(),c("span",Rt,l(b.value.account_name)+" - ****"+l((_=b.value.account_number)==null?void 0:_.slice(-4)),1)):(r(),c("span",St,"Select account"))]}),_:1},8,["modelValue","options","disabled"]),s(a).errors.bank_account_id?(r(),c("p",$t,l(s(a).errors.bank_account_id),1)):m("",!0)])):m("",!0),t("div",At,[i(s(k),{label:"Redeem Points",icon:"pi pi-gift",disabled:d.value<100||s(a).points>d.value,onClick:z},null,8,["disabled"])])])]),_:1}),i(s(C),null,{title:n(()=>[...e[16]||(e[16]=[w("Points Progress",-1)])]),content:n(()=>[t("div",Et,[t("div",Nt,[t("div",Lt,l(d.value.toLocaleString()),1),e[17]||(e[17]=t("p",{class:"text-sm text-gray-500"},"Available Points",-1))]),i(s(ot),{value:Y.value,showValue:!1,class:"h-3"},null,8,["value"]),t("div",Tt,[e[18]||(e[18]=t("span",null,"0",-1)),t("span",null,l(h.value.toLocaleString())+" earned",1)]),i(s(U)),e[19]||(e[19]=t("div",{class:"space-y-2 text-sm"},[t("div",{class:"flex justify-between"},[t("span",{class:"text-gray-600 dark:text-gray-400"},"100 points"),t("span",{class:"font-medium"},"= $1.00")]),t("div",{class:"flex justify-between"},[t("span",{class:"text-gray-600 dark:text-gray-400"},"Min. redemption"),t("span",{class:"font-medium"},"100 points")])],-1))])]),_:1})]),i(s(C),null,{title:n(()=>[...e[20]||(e[20]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-history text-primary"}),w(" Reward Activity ")],-1)])]),content:n(()=>[f.rewards.data.length?(r(),c("div",Dt,[(r(!0),c(Q,null,X(f.rewards.data,o=>(r(),c("div",{key:o.id,class:"p-4 border rounded-xl dark:border-gray-700 bg-white dark:bg-gray-800 space-y-2"},[t("div",Ft,[t("h3",Ut,l(o.title),1),i(s(st),{value:o.status,severity:q(o.status)},null,8,["value","severity"])]),t("div",It,[t("span",{class:T(["text-lg font-bold",o.points>=0?"text-green-600":"text-red-600"])},l(o.points>=0?"+":"")+l(o.points)+" pts ",3)]),o.description?(r(),c("p",Mt,l(o.description),1)):m("",!0),t("p",Bt,l(o.source||o.type),1),t("p",Ot,l(G(o.earned_date||o.created_at)),1)]))),128))])):(r(),c("div",Yt,[...e[21]||(e[21]=[t("i",{class:"pi pi-gift text-4xl text-gray-300 dark:text-gray-600 mb-3"},null,-1),t("p",{class:"text-gray-600 dark:text-gray-400"},"No rewards yet. Complete transactions to earn points!",-1)])]))]),_:1})]),i(s(F),{visible:v.value,"onUpdate:visible":e[3]||(e[3]=o=>v.value=o),modal:"",header:"Confirm Redemption",style:{width:"450px"},closable:!0},{footer:n(()=>[t("div",te,[i(s(k),{label:"Cancel",severity:"secondary",outlined:"",onClick:$}),i(s(k),{label:"Continue",icon:"pi pi-arrow-right",onClick:W})])]),default:n(()=>{var o;return[t("div",Kt,[e[27]||(e[27]=t("div",{class:"text-center"},[t("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center"},[t("i",{class:"pi pi-gift text-3xl text-purple-600 dark:text-purple-400"})]),t("p",{class:"text-gray-700 dark:text-gray-300"},"You are about to redeem:")],-1)),t("div",qt,[t("div",zt,[e[22]||(e[22]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Points:",-1)),t("span",Wt,l(s(a).points.toLocaleString())+" pts",1)]),t("div",Gt,[e[23]||(e[23]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Cash Value:",-1)),t("span",Ht,"$"+l(R.value),1)]),i(s(U)),t("div",Jt,[e[24]||(e[24]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Redemption Type:",-1)),t("span",Qt,l((o=K.value)==null?void 0:o.label),1)]),s(a).redemption_type==="cash"&&b.value?(r(),c("div",Xt,[e[25]||(e[25]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Credit To:",-1)),t("span",Zt,l(b.value.account_name),1)])):m("",!0)]),i(s(I),{severity:"info",closable:!1},{default:n(()=>[...e[26]||(e[26]=[t("span",{class:"text-sm"},"You will need to enter your 6-digit PIN to confirm.",-1)])]),_:1})])]}),_:1},8,["visible"]),i(s(F),{visible:x.value,"onUpdate:visible":e[5]||(e[5]=o=>x.value=o),modal:"",header:"Enter Transaction PIN",style:{width:"400px"},closable:!y.value},{footer:n(()=>[t("div",oe,[i(s(k),{label:"Cancel",severity:"secondary",outlined:"",disabled:y.value,onClick:$},null,8,["disabled"]),i(s(k),{label:"Confirm & Redeem",icon:"pi pi-check",loading:y.value,disabled:s(a).pin.length!==6,onClick:S},null,8,["loading","disabled"])])]),default:n(()=>[t("div",ee,[e[28]||(e[28]=t("div",{class:"text-center"},[t("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center"},[t("i",{class:"pi pi-lock text-3xl text-blue-600 dark:text-blue-400"})]),t("p",{class:"text-gray-700 dark:text-gray-300"},"Enter your 6-digit transaction PIN")],-1)),t("div",se,[i(s(lt),{modelValue:s(a).pin,"onUpdate:modelValue":e[4]||(e[4]=o=>s(a).pin=o),placeholder:"Enter PIN",feedback:!1,toggleMask:"",inputClass:"w-full text-center text-2xl tracking-[0.5em] font-mono",maxlength:6,disabled:y.value,onKeyup:Z(S,["enter"])},null,8,["modelValue","disabled"]),s(a).errors.pin?(r(),c("p",ae,l(s(a).errors.pin),1)):m("",!0)])])]),_:1},8,["visible","closable"])]),_:1}))}};export{je as default};
