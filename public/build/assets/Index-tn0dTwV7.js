import{k as R,l as L,f as B,c as _,d as l,u as a,p as E,w as n,a as t,t as d,h as I,b as S,o as v,j as V,i as g,e as T,F as Y,q as z}from"./app-CA1i2YFa.js";import{a as w}from"./index--P6FZV4c.js";import{s as M}from"./index-DC4zil2T.js";import{s as O}from"./index-B1mLcqJW.js";import{s as G}from"./index-Ak-akmjO.js";import{s as H}from"./index-C6YAIT0P.js";import{s as J,a as p}from"./index-CqxCjMye.js";import{s as K}from"./index-DeMJf8qq.js";import{s as Q}from"./index-DM2-HlH9.js";import{s as W}from"./index-DmLVmpkR.js";import{c as X,D as Z}from"./DashboardLayout-DRg9y8FG.js";import{u as P}from"./useCurrency-0zMdEeak.js";/* empty css            */import"./index-Ci-OdYiI.js";import"./index-Dwux84ML.js";import"./index-C6Y9AM6B.js";import"./index-DAzbYYc_.js";import"./index-Biqr0saZ.js";import"./index-BoV9MCm-.js";import"./index-DbbPMp9d.js";import"./index-29HbjQsj.js";import"./index-CaTSTKaC.js";import"./index-DTnnwFGf.js";import"./AppLogo-COC7CAPP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BJ7weD9P.js";const ee={class:"max-w-7xl mx-auto"},te={class:"flex flex-col gap-4 mb-6 sm:flex-row sm:items-center sm:justify-between"},ae={class:"text-center py-12"},se={class:"font-mono text-sm"},le={class:"font-medium text-gray-900 dark:text-white"},oe={class:"text-sm text-gray-500"},re={class:"font-semibold text-gray-900 dark:text-white"},ne={class:"text-sm text-gray-600 dark:text-gray-400"},ie={class:"text-sm"},de={class:"space-y-4"},ce={key:0,class:"flex items-center justify-between"},ue={class:"text-gray-500"},me={key:1},pe={class:"flex items-center justify-between py-2"},ye={class:"font-medium"},be={class:"text-sm text-gray-500"},fe={class:"text-right"},xe={class:"font-semibold"},ve={key:0,class:"mt-1 text-xs text-gray-500"},we={class:"mt-1 text-xs text-gray-500"},Ge={__name:"Index",props:{withdrawals:Object,bankAccounts:Array},setup($){const f=$,y=R(),D=L(),{formatCurrency:h}=P(),x=V(!1),u=V(!1),r=B({bank_account_id:null,amount:null,reason:""}),c=T(()=>f.bankAccounts.find(o=>o.id===r.bank_account_id)),U=o=>({pending:"warn",approved:"info",completed:"success",rejected:"danger",failed:"danger",cancelled:"secondary"})[o]||"secondary",j=o=>o.charAt(0).toUpperCase()+o.slice(1),k=()=>{var o;r.reset(),r.bank_account_id=(o=f.bankAccounts[0])==null?void 0:o.id,x.value=!0},q=()=>{var o;if(!r.bank_account_id||!r.amount){y.add({severity:"error",summary:"Validation Error",detail:"Please select an account and enter amount",life:3e3});return}if(r.amount>((o=c.value)==null?void 0:o.balance)/100){y.add({severity:"error",summary:"Insufficient Balance",detail:"Withdrawal amount exceeds available balance",life:3e3});return}u.value=!0,r.transform(e=>({...e,amount:Math.round((e.amount||0)*100)})).post(route("withdrawals.store"),{preserveScroll:!0,onSuccess:()=>{x.value=!1,r.reset(),y.add({severity:"success",summary:"Withdrawal Requested",detail:"Your withdrawal request has been submitted for approval",life:5e3})},onError:e=>{y.add({severity:"error",summary:"Withdrawal Failed",detail:e.amount||e.error||"Unable to process withdrawal",life:5e3})},onFinish:()=>{u.value=!1}})},F=o=>{D.require({message:`Are you sure you want to cancel this withdrawal of ${h(o.amount,o.currency)}?`,header:"Cancel Withdrawal",icon:"pi pi-exclamation-triangle",acceptLabel:"Yes, Cancel",rejectLabel:"No",acceptClass:"p-button-danger",accept:()=>{z.post(route("withdrawals.cancel",o.id),{},{preserveScroll:!0,onSuccess:()=>{y.add({severity:"success",summary:"Withdrawal Cancelled",detail:"Amount has been refunded to your account",life:4e3})},onError:e=>{y.add({severity:"error",summary:"Cancellation Failed",detail:e.error||"Unable to cancel withdrawal",life:3e3})}})}})},N=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(o,e)=>(v(),_(Y,null,[l(a(E),{title:"Withdrawals"}),l(Z,{title:"Withdrawals"},{default:n(()=>[l(a(X)),t("div",ee,[t("div",te,[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Withdrawals "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Request funds withdrawal to your external bank account ")],-1)),l(a(w),{label:"New Withdrawal",icon:"pi pi-plus",onClick:k,size:"large"})]),l(a(M),null,{content:n(()=>[l(a(J),{value:f.withdrawals.data,rows:20,paginator:f.withdrawals.data.length>0,responsiveLayout:"scroll",stripedRows:""},{empty:n(()=>[t("div",ae,[e[6]||(e[6]=t("i",{class:"pi pi-inbox text-6xl text-gray-300 dark:text-gray-600 mb-4"},null,-1)),e[7]||(e[7]=t("p",{class:"text-gray-500 dark:text-gray-400"},"No withdrawals yet",-1)),l(a(w),{label:"Make Your First Withdrawal",icon:"pi pi-plus",class:"mt-4",outlined:"",onClick:k})])]),default:n(()=>[l(a(p),{field:"reference_number",header:"Reference",style:{"min-width":"150px"}},{body:n(({data:s})=>[t("span",se,d(s.reference_number),1)]),_:1}),l(a(p),{field:"bank_account",header:"Account",style:{"min-width":"200px"}},{body:n(({data:s})=>{var b,i,m;return[t("div",null,[t("p",le,d((i=(b=s.bank_account)==null?void 0:b.account_type)==null?void 0:i.name),1),t("p",oe," ****"+d((m=s.bank_account)==null?void 0:m.account_number.slice(-4)),1)])]}),_:1}),l(a(p),{field:"amount",header:"Amount",style:{"min-width":"120px"}},{body:n(({data:s})=>[t("span",re,d(a(h)(s.amount,s.currency)),1)]),_:1}),l(a(p),{field:"status",header:"Status",style:{"min-width":"120px"}},{body:n(({data:s})=>[l(a(K),{value:j(s.status),severity:U(s.status)},null,8,["value","severity"])]),_:1}),l(a(p),{field:"reason",header:"Reason",style:{"min-width":"200px"}},{body:n(({data:s})=>[t("span",ne,d(s.reason||"-"),1)]),_:1}),l(a(p),{field:"created_at",header:"Date",style:{"min-width":"180px"}},{body:n(({data:s})=>[t("span",ie,d(N(s.created_at)),1)]),_:1}),l(a(p),{header:"Actions",style:{"min-width":"120px"}},{body:n(({data:s})=>[s.status==="pending"?(v(),I(a(w),{key:0,label:"Cancel",icon:"pi pi-times",severity:"danger",size:"small",outlined:"",onClick:b=>F(s)},null,8,["onClick"])):S("",!0)]),_:1})]),_:1},8,["value","paginator"])]),_:1})]),l(a(Q),{visible:x.value,"onUpdate:visible":e[4]||(e[4]=s=>x.value=s),modal:"",header:"New Withdrawal Request",style:{width:"600px"},closable:!u.value},{footer:n(()=>[l(a(w),{label:"Cancel",severity:"secondary",outlined:"",onClick:e[3]||(e[3]=s=>x.value=!1),disabled:u.value},null,8,["disabled"]),l(a(w),{label:"Submit Request",icon:"pi pi-check",onClick:q,loading:u.value,disabled:!a(r).bank_account_id||!a(r).amount},null,8,["loading","disabled"])]),default:n(()=>{var s,b;return[t("div",de,[l(a(W),{severity:"info",closable:!1},{default:n(()=>[...e[8]||(e[8]=[t("p",{class:"text-sm"}," Withdrawal requests require admin approval. Funds will be deducted from your account immediately and refunded if rejected. ",-1)])]),_:1}),t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},[g(" Withdraw From "),t("span",{class:"text-red-500"},"*")],-1)),l(a(H),{modelValue:a(r).bank_account_id,"onUpdate:modelValue":e[0]||(e[0]=i=>a(r).bank_account_id=i),options:f.bankAccounts,optionLabel:"account_type.name",optionValue:"id",placeholder:"Select Account",class:"w-full",disabled:u.value},{value:n(i=>{var m,C,A;return[i.value?(v(),_("div",ce,[t("span",null,d((C=(m=c.value)==null?void 0:m.account_type)==null?void 0:C.name),1),t("span",ue,"****"+d((A=c.value)==null?void 0:A.account_number.slice(-4)),1)])):(v(),_("span",me,d(i.placeholder),1))]}),option:n(i=>{var m;return[t("div",pe,[t("div",null,[t("div",ye,d((m=i.option.account_type)==null?void 0:m.name),1),t("div",be,"****"+d(i.option.account_number.slice(-4)),1)]),t("div",fe,[t("div",xe,d(a(h)(i.option.balance,i.option.currency)),1),e[9]||(e[9]=t("div",{class:"text-xs text-gray-500"},"Available",-1))])])]}),_:1},8,["modelValue","options","disabled"]),c.value?(v(),_("p",ve," Available Balance: "+d(a(h)(c.value.balance,c.value.currency)),1)):S("",!0)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},[g(" Amount "),t("span",{class:"text-red-500"},"*")],-1)),l(a(O),{modelValue:a(r).amount,"onUpdate:modelValue":e[1]||(e[1]=i=>a(r).amount=i),mode:"currency",currency:((s=c.value)==null?void 0:s.currency)||"USD",locale:"en-US",placeholder:"0.00",class:"w-full",min:1,max:c.value?c.value.balance/100:void 0,disabled:!a(r).bank_account_id||u.value},null,8,["modelValue","currency","max","disabled"]),e[12]||(e[12]=t("p",{class:"mt-1 text-xs text-gray-500"}," Enter the amount you want to withdraw ",-1))]),t("div",null,[e[13]||(e[13]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"}," Reason (Optional) ",-1)),l(a(G),{modelValue:a(r).reason,"onUpdate:modelValue":e[2]||(e[2]=i=>a(r).reason=i),rows:"3",placeholder:"e.g., Personal expenses, Emergency...",class:"w-full",maxlength:"500",disabled:u.value},null,8,["modelValue","disabled"]),t("p",we,d(((b=a(r).reason)==null?void 0:b.length)||0)+"/500 characters ",1)]),l(a(W),{severity:"warn",closable:!1},{default:n(()=>[...e[14]||(e[14]=[t("p",{class:"text-sm"},[t("strong",null,"Important:"),g(" The amount will be deducted immediately. If your withdrawal is rejected, it will be refunded to your account. ")],-1)])]),_:1})])]}),_:1},8,["visible","closable"])]),_:1})],64))}};export{Ge as default};
