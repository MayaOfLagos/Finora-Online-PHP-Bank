import{k as be,f as xe,c as b,d as v,u as l,p as we,w as x,a as t,s as ee,i as M,g as R,b as k,j as N,o as m,F as U,r as X,n as E,t as y,e as O}from"./app-ouRiD5HY.js";import{a as A}from"./index-BbivnfWc.js";import{s as V}from"./index-DKtzkE36.js";import{s as he}from"./index-DXbMLQl6.js";import{s as D}from"./index-Qjxjmd6A.js";import{s as ke}from"./index-Dz8uLCAb.js";import{_ as _e}from"./DashboardLayout-Bgq4JauI.js";import{u as Ce}from"./useCurrency-0zMdEeak.js";/* empty css            */import"./_plugin-vue_export-helper-DfEtbB7c.js";const Pe={class:"max-w-2xl mx-auto"},Ee={class:"max-w-2xl mx-auto"},Fe={class:"space-y-4"},Se=["onClick"],ze={class:"flex items-center justify-between"},je={class:"flex items-center gap-3"},Te={class:"font-medium text-gray-900 dark:text-white"},Ge={class:"text-sm text-gray-500 dark:text-gray-400"},$e={class:"text-lg font-bold text-gray-900 dark:text-white"},Be={class:"flex justify-end gap-3 pt-4"},Me={class:"space-y-4"},Ae={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Ie={key:0,class:"space-y-3"},Re=["onClick"],Ye={class:"flex items-center gap-4"},qe={class:"flex-1"},Ne={class:"font-semibold text-gray-900 dark:text-white"},Ue={key:1,class:"border-t border-gray-200 dark:border-gray-700"},Oe={key:2,class:"space-y-3"},Ve=["onClick"],De={class:"flex items-center gap-4"},Ke={class:"flex-1"},Le={class:"font-semibold text-gray-900 dark:text-white"},Xe={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},He={key:0,class:"text-sm"},Je={key:1,class:"text-sm"},Qe={class:"flex justify-between gap-3 pt-4"},We={class:"space-y-4"},Ze={class:"flex justify-between mt-2 text-xs text-gray-500"},et={class:"text-sm"},tt={class:"text-sm mt-2"},at={class:"flex justify-between gap-3 pt-4"},rt={class:"py-8"},st={key:0,class:"text-center"},ot={class:"text-xl font-bold text-gray-900 dark:text-white"},nt={class:"mt-2 text-gray-500"},lt={key:1,class:"text-center"},it={class:"mt-2 text-gray-500"},dt={class:"space-y-3"},ct={class:"font-semibold text-gray-900 dark:text-white"},ut={class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-line"},yt={key:0,class:"mt-6 p-4 rounded-lg bg-gray-50 dark:bg-gray-800 text-left"},mt={class:"space-y-2"},pt={class:"text-gray-500 capitalize"},ft={class:"font-mono text-gray-900 dark:text-white"},vt={class:"mt-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800"},gt={class:"text-lg font-mono font-bold text-gray-900 dark:text-white"},bt={class:"p-4 mt-6 text-left rounded-lg bg-gray-50 dark:bg-gray-800"},xt={class:"space-y-2"},wt={class:"flex justify-between"},ht={class:"font-bold text-gray-900 dark:text-white"},kt={class:"flex justify-between"},_t={class:"text-gray-900 dark:text-white"},Ct={class:"flex justify-between"},Pt={class:"text-gray-900 dark:text-white"},Et={class:"flex justify-center gap-3 mt-6"},It={__name:"Mobile",props:{accounts:{type:Array,default:()=>[]},enabledGateways:{type:Array,default:()=>[]},depositLimits:{type:Object,default:()=>({daily:1e5,perTransaction:5e4})},todaysTotal:{type:Number,default:0},auth:{type:Object,default:()=>{}}},setup(T){const P=T,c=be(),{formatCurrency:H}=Ce(),n=xe({bank_account_id:null,gateway:null,amount:null}),w=N(0),i=N(!1),G=N(!1),F=N(null),p=N("idle"),ie=[{label:"Select Account"},{label:"Choose Gateway"},{label:"Enter Amount"},{label:"Complete"}],I=O(()=>P.accounts.find(r=>r.id===n.bank_account_id)),f=O(()=>P.enabledGateways.find(r=>r.value===n.gateway)),J=O(()=>(P.depositLimits.daily-P.todaysTotal)/100),te=O(()=>Math.min(P.depositLimits.perTransaction/100,J.value)),Q=O(()=>n.bank_account_id&&n.gateway&&n.amount&&n.amount>0&&n.amount<=te.value),W=()=>{w.value===0&&n.bank_account_id?w.value=1:w.value===1&&n.gateway?w.value=2:w.value===2&&Q.value&&de()},ae=()=>{w.value>0&&w.value--},de=()=>{if(!Q.value){c.add({severity:"error",summary:"Invalid Deposit",detail:"Please verify all deposit details",life:3e3});return}i.value=!0,n.transform(r=>({...r,amount:Math.round((r.amount||0)*100)})).post(route("deposits.mobile.initiate"),{preserveScroll:!0,onSuccess:r=>{var a,d,g;const e=((a=r.props.flash)==null?void 0:a.deposit)||F.value;if(F.value=e||n.data(),!((d=F.value)!=null&&d.uuid)){i.value=!1,c.add({severity:"error",summary:"Deposit Missing",detail:"Could not start payment because the deposit reference was not returned.",life:5e3});return}console.log("Selected gateway code:",n.gateway),console.log("All enabled gateways:",P.enabledGateways);const o=["paystack","stripe","paypal","flutterwave","razorpay"].includes(n.gateway);if(console.log("Is automatic gateway?",o),!o){const u=P.enabledGateways.find(h=>h.value===n.gateway);if(console.log("Found manual gateway:",u),u){ce(u);return}}if(n.gateway==="paystack")ue(e);else if(n.gateway==="stripe")ye(e);else if(n.gateway==="paypal")me(e);else if(n.gateway==="flutterwave")pe(e);else if(n.gateway==="razorpay")ve(e);else{i.value=!1;const u=((g=P.enabledGateways.find(h=>h.value===n.gateway))==null?void 0:g.label)||n.gateway;c.add({severity:"error",summary:"Gateway Not Configured",detail:`${u} integration is not yet implemented.`,life:6e3})}},onError:r=>{i.value=!1,c.add({severity:"error",summary:"Deposit Failed",detail:r.general||r.gateway||r.amount||"Unable to initiate deposit",life:5e3})}})},ce=r=>{i.value=!1,p.value="success",G.value=!0,w.value=3,c.add({severity:"info",summary:"Manual Deposit Instructions",detail:`Your deposit request has been created. Follow the instructions for ${r.label}`,life:8e3})},ue=r=>{const e=document.createElement("script");e.src="https://js.paystack.co/v1/inline.js",e.onload=()=>{var o,a,d,g;const s={key:(r==null?void 0:r.gateway_public_key)||((o=f.value)==null?void 0:o.public_key)||"pk_test_dummy",email:((a=P.auth.user)==null?void 0:a.email)||"user@example.com",amount:Math.round(n.amount*100),ref:(r==null?void 0:r.reference)||"ref_"+Date.now(),metadata:{custom_fields:[{display_name:"Deposit UUID",variable_name:"deposit_uuid",value:(r==null?void 0:r.uuid)||((d=F.value)==null?void 0:d.uuid)},{display_name:"User Email",variable_name:"user_email",value:(g=P.auth.user)==null?void 0:g.email}]},callback:function(u){u.status==="success"&&Y(u.reference)},onClose:function(){i.value=!1,setTimeout(()=>{p.value!=="success"&&p.value!=="processing"&&c.add({severity:"warn",summary:"Payment Cancelled",detail:"You cancelled the payment. Your deposit was saved as pending.",life:5e3})},500)},onSuccess:function(u){Y(u.reference)}};try{PaystackPop.setup(s).openIframe()}catch(u){i.value=!1,c.add({severity:"error",summary:"Paystack Setup Failed",detail:u.message||"Could not initialize payment popup",life:5e3})}},e.onerror=()=>{i.value=!1,c.add({severity:"error",summary:"Payment Gateway Error",detail:"Failed to load Paystack. Please try again.",life:5e3})},document.body.appendChild(e)},ye=async r=>{var s;const e=(r==null?void 0:r.gateway_public_key)||((s=f.value)==null?void 0:s.public_key);if(!e){i.value=!1,c.add({severity:"error",summary:"Stripe Configuration Error",detail:"Stripe Publishable Key is missing. Contact support.",life:5e3});return}try{if(window.Stripe)re(e,r);else{const o=document.createElement("script");o.src="https://js.stripe.com/v3/",o.onload=()=>{re(e,r)},o.onerror=()=>{i.value=!1,c.add({severity:"error",summary:"Payment Gateway Error",detail:"Failed to load Stripe. Please try again.",life:5e3})},document.body.appendChild(o)}}catch{i.value=!1,c.add({severity:"error",summary:"Stripe Error",detail:"An error occurred while initializing Stripe.",life:5e3})}},re=async(r,e)=>{var s;try{const o=window.Stripe(r),a=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content,d=await axios.post(route("deposits.mobile.stripe.intent"),{deposit_uuid:e.uuid},{headers:{"X-CSRF-TOKEN":a,"Content-Type":"application/json"}});if(!d.data.success)throw new Error(d.data.message||"Failed to create payment intent");const{client_secret:g}=d.data,h=o.elements().create("card"),_=document.createElement("div");_.id="stripe-modal-overlay",_.style.cssText="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9998; display: flex; align-items: center; justify-content: center;";const S=document.createElement("div");S.id="stripe-modal-container",S.style.cssText="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); max-width: 400px; width: 90%;";const $=document.createElement("h3");$.textContent="Enter Card Details",$.style.cssText="margin-top: 0; margin-bottom: 20px; color: #333; font-size: 18px; font-weight: 600;";const j=document.createElement("div");j.id="card-element",j.style.cssText="border: 1px solid #ddd; padding: 10px; border-radius: 4px; margin-bottom: 20px;";const Z=document.createElement("div");Z.id="card-errors",Z.style.cssText="color: #fa755a; margin-bottom: 10px; min-height: 20px;";const L=document.createElement("div");L.style.cssText="display: flex; gap: 10px; justify-content: space-between;";const C=document.createElement("button");C.textContent=`Pay $${n.amount.toFixed(2)}`,C.style.cssText="flex: 1; padding: 12px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 16px;";const q=document.createElement("button");q.textContent="Cancel",q.style.cssText="flex: 1; padding: 12px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 16px;",L.appendChild(C),L.appendChild(q),S.appendChild($),S.appendChild(j),S.appendChild(Z),S.appendChild(L),_.appendChild(S),document.body.appendChild(_),h.mount("#card-element"),h.on("change",z=>{const B=document.getElementById("card-errors");z.error?B.textContent=z.error.message:B.textContent=""}),C.onclick=async()=>{C.disabled=!0,C.textContent="Processing...";try{const z=await o.confirmCardPayment(g,{payment_method:{card:h,billing_details:{email:page.props.auth.user.email}}});if(z.error){const B=document.getElementById("card-errors");B.textContent=z.error.message,C.disabled=!1,C.textContent=`Pay $${n.amount.toFixed(2)}`}else if(z.paymentIntent.status==="succeeded")se(),Y(z.paymentIntent.id);else{const B=document.getElementById("card-errors");B.textContent="Payment requires additional authentication. Please try again.",C.disabled=!1,C.textContent=`Pay $${n.amount.toFixed(2)}`}}catch{const B=document.getElementById("card-errors");B.textContent="An error occurred. Please try again.",C.disabled=!1,C.textContent=`Pay $${n.amount.toFixed(2)}`}},q.onclick=()=>{se(),i.value=!1,c.add({severity:"warn",summary:"Payment Cancelled",detail:"You cancelled the card payment. Your deposit was saved as pending.",life:5e3})},_.onclick=z=>{z.target===_&&q.click()}}catch(o){i.value=!1,c.add({severity:"error",summary:"Payment Error",detail:o.message||"Failed to initialize Stripe payment.",life:5e3})}},se=()=>{const r=document.getElementById("stripe-modal-overlay");r&&r.remove()},me=r=>{var o;const e=(r==null?void 0:r.gateway_public_key)||((o=f.value)==null?void 0:o.public_key);if(!e){i.value=!1,c.add({severity:"error",summary:"PayPal Configuration Error",detail:"PayPal Client ID is missing. Contact support.",life:5e3});return}if(window.paypal){oe(r);return}const s=document.createElement("script");s.src=`https://www.paypal.com/sdk/js?client-id=${e}&currency=USD`,s.onload=()=>{oe(r)},s.onerror=()=>{i.value=!1,c.add({severity:"error",summary:"Payment Gateway Error",detail:"Failed to load PayPal. Please try again.",life:5e3})},document.body.appendChild(s)},oe=r=>{let e=document.getElementById("paypal-button-container");if(!e){e=document.createElement("div"),e.id="paypal-button-container",e.style.cssText="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); min-width: 300px;",document.body.appendChild(e);const s=document.createElement("div");s.id="paypal-overlay",s.style.cssText="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9998;",s.onclick=()=>{K()},document.body.appendChild(s)}window.paypal.Buttons({createOrder:function(s,o){var a,d;return o.order.create({purchase_units:[{amount:{value:n.amount.toFixed(2),currency_code:"USD"},description:`Deposit to ${(d=(a=I.value)==null?void 0:a.account_type)==null?void 0:d.name}`,custom_id:r==null?void 0:r.uuid}]})},onApprove:function(s,o){return o.order.capture().then(function(a){K(),Y(a.id)})},onCancel:function(s){K(),i.value=!1,c.add({severity:"warn",summary:"Payment Cancelled",detail:"You cancelled the PayPal payment. Your deposit was saved as pending.",life:5e3})},onError:function(s){K(),i.value=!1,c.add({severity:"error",summary:"PayPal Error",detail:"An error occurred during payment. Please try again.",life:5e3})}}).render("#paypal-button-container")},K=()=>{const r=document.getElementById("paypal-button-container"),e=document.getElementById("paypal-overlay");r&&r.remove(),e&&e.remove()},pe=async r=>{var e;try{const s=(e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.content,o=await axios.post(route("deposits.mobile.flutterwave.link"),{deposit_uuid:r.uuid},{headers:{"X-CSRF-TOKEN":s,"Content-Type":"application/json"}});if(!o.data.success)throw new Error(o.data.message||"Failed to create payment link");if(window.FlutterwaveCheckout)ne(r,o.data);else{const a=document.createElement("script");a.src="https://checkout.flutterwave.com/v3.js",a.onload=()=>{ne(r,o.data)},a.onerror=()=>{i.value=!1,c.add({severity:"error",summary:"Payment Gateway Error",detail:"Failed to load Flutterwave. Please try again.",life:5e3})},document.body.appendChild(a)}}catch(s){i.value=!1,c.add({severity:"error",summary:"Flutterwave Error",detail:s.message||"Failed to initialize Flutterwave payment.",life:5e3})}},ne=(r,e)=>{var s,o;window.FlutterwaveCheckout({public_key:e.public_key,tx_ref:e.tx_ref,amount:e.amount,currency:e.currency,payment_options:"card,banktransfer",customer:{email:e.customer_email,name:e.customer_name},customizations:{title:"Finora Bank Deposit",description:`Fund your ${(o=(s=I.value)==null?void 0:s.account_type)==null?void 0:o.name}`,logo:"/logo.png"},callback:a=>{const d=a.flw_ref||a.tx_ref||a.transaction_id||a.id;if(!d){i.value=!1,c.add({severity:"error",summary:"Payment Reference Missing",detail:"Transaction reference is missing. Please contact support.",life:6e3});return}fe(),Y(d)},onclose:()=>{p.value!=="processing"&&p.value!=="success"&&(i.value=!1,c.add({severity:"warn",summary:"Payment Cancelled",detail:"You cancelled the Flutterwave payment. Your deposit was saved as pending.",life:5e3}))}})},fe=()=>{const r=document.querySelector(".flutterwave-modal-container")||document.querySelector(".flutterwave-modal")||document.querySelector('[id*="flutterwave"]')||document.querySelector('iframe[src*="flutterwave"]');r&&r.remove();const e=document.querySelector(".flutterwave-overlay")||document.querySelector('[class*="flw-modal-overlay"]');e&&e.remove()},ve=async r=>{var e;try{const s=(e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.content,o=await axios.post(route("deposits.mobile.razorpay.order"),{deposit_uuid:r.uuid},{headers:{"X-CSRF-TOKEN":s,"Content-Type":"application/json"}});if(!o.data.success)throw new Error(o.data.message||"Failed to create Razorpay order");if(window.Razorpay)le(r,o.data);else{const a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.onload=()=>{le(r,o.data)},a.onerror=()=>{i.value=!1,c.add({severity:"error",summary:"Payment Gateway Error",detail:"Failed to load Razorpay. Please try again.",life:5e3})},document.body.appendChild(a)}}catch(s){i.value=!1,c.add({severity:"error",summary:"Razorpay Error",detail:s.message||"Failed to initialize Razorpay payment.",life:5e3})}},le=(r,e)=>{var o,a;new window.Razorpay({key:e.key_id,amount:e.amount,currency:e.currency,order_id:e.order_id,name:"Finora Bank",description:`Deposit to ${(a=(o=I.value)==null?void 0:o.account_type)==null?void 0:a.name}`,customer_id:page.props.auth.user.id,prefill:{name:e.customer_name,email:e.customer_email},handler:function(d){Y(d.razorpay_payment_id)},modal:{ondismiss:function(){i.value=!1,c.add({severity:"warn",summary:"Payment Cancelled",detail:"You cancelled the Razorpay payment. Your deposit was saved as pending.",life:5e3})}},theme:{color:"#007bff"}}).open()},Y=r=>{var e,s,o;if(p.value="processing",G.value=!0,!((e=F.value)!=null&&e.uuid)){p.value="error",i.value=!1,c.add({severity:"error",summary:"Confirmation Failed",detail:"Payment reference is missing. Please contact support with your Paystack receipt.",life:6e3});return}try{const a=route("deposits.mobile.callback",{mobileDeposit:F.value.uuid}),d=((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content)||((o=document.head.querySelector('meta[name="csrf-token"]'))==null?void 0:o.content);axios.post(a,{gateway_reference:r},{headers:{"X-CSRF-TOKEN":d,Accept:"application/json","Content-Type":"application/json"}}).then(g=>{var u;p.value="success",F.value=((u=g.data)==null?void 0:u.deposit)??F.value,w.value=3,i.value=!1,c.add({severity:"success",summary:"Payment Successful",detail:"Your deposit has been completed",life:5e3})}).catch(g=>{var h,_;p.value="error",i.value=!1;const u=((_=(h=g.response)==null?void 0:h.data)==null?void 0:_.message)||"Payment received but confirmation failed. Please contact support.";c.add({severity:"error",summary:"Confirmation Failed",detail:u,life:6e3})})}catch{p.value="error",i.value=!1,c.add({severity:"error",summary:"Confirmation Failed",detail:"Could not confirm payment due to a routing error. Please contact support.",life:6e3})}},ge=()=>{n.reset(),w.value=0,G.value=!1,F.value=null,p.value="idle"};return(r,e)=>(m(),b(U,null,[v(l(we),{title:"Mobile Deposit"}),v(_e,{title:"Mobile Deposit"},{default:x(()=>[t("div",Pe,[v(l(ee),{href:"/deposits",class:"inline-flex items-center gap-2 mb-6 text-sm text-gray-500 transition-colors hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},{default:x(()=>[...e[1]||(e[1]=[t("i",{class:"pi pi-arrow-left"},null,-1),M(" Back to Deposits ",-1)])]),_:1}),e[2]||(e[2]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Mobile Deposit "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Pay via secure payment gateway ")],-1))]),t("div",Ee,[G.value?k("",!0):(m(),R(l(V),{key:0,class:"mb-6"},{content:x(()=>[v(l(ke),{model:ie,activeStep:w.value,readonly:!0},null,8,["activeStep"])]),_:1})),w.value===0&&!G.value?(m(),R(l(V),{key:1,class:"shadow-lg"},{title:x(()=>[...e[3]||(e[3]=[t("div",{class:"flex items-center gap-2 text-lg"},[t("i",{class:"pi pi-wallet text-primary-500"}),M(" Select Deposit Account ")],-1)])]),content:x(()=>[t("div",Fe,[(m(!0),b(U,null,X(P.accounts,s=>{var o;return m(),b("div",{key:s.id,onClick:a=>l(n).bank_account_id=s.id,class:E(["p-4 transition-all duration-300 border-2 rounded-lg cursor-pointer",[l(n).bank_account_id===s.id?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"]])},[t("div",ze,[t("div",je,[t("div",{class:E(["flex items-center justify-center w-10 h-10 rounded-full transition-all",[l(n).bank_account_id===s.id?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-500"]])},[t("i",{class:E(["pi",[l(n).bank_account_id===s.id?"pi-check":"pi-wallet"]])},null,2)],2),t("div",null,[t("p",Te,y((o=s.account_type)==null?void 0:o.name),1),t("p",Ge," ****"+y(s.account_number.slice(-4)),1)])]),t("p",$e,y(l(H)(s.balance,s.currency)),1)])],10,Se)}),128)),t("div",Be,[v(l(ee),{href:"/deposits"},{default:x(()=>[v(l(A),{label:"Cancel",outlined:""})]),_:1}),v(l(A),{label:"Continue",icon:"pi pi-arrow-right",disabled:!l(n).bank_account_id,onClick:W},null,8,["disabled"])])])]),_:1})):k("",!0),w.value===1&&!G.value?(m(),R(l(V),{key:2,class:"shadow-lg"},{title:x(()=>[...e[4]||(e[4]=[t("div",{class:"flex items-center gap-2 text-lg"},[t("i",{class:"pi pi-credit-card text-primary-500"}),M(" Choose Payment Method ")],-1)])]),content:x(()=>{var s,o;return[t("div",Me,[t("p",Ae,[e[5]||(e[5]=M(" Depositing to ",-1)),t("strong",null,y((o=(s=I.value)==null?void 0:s.account_type)==null?void 0:o.name),1)]),T.enabledGateways.filter(a=>a.type==="automatic").length>0?(m(),b("div",Ie,[e[7]||(e[7]=t("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"Automatic Payment Methods",-1)),(m(!0),b(U,null,X(T.enabledGateways.filter(a=>a.type==="automatic"),a=>(m(),b("div",{key:a.value,onClick:d=>l(n).gateway=a.value,class:E(["p-4 transition-all duration-300 border-2 rounded-lg cursor-pointer",[l(n).gateway===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"]])},[t("div",Ye,[t("div",{class:E(["flex items-center justify-center w-12 h-12 rounded-lg transition-all",[l(n).gateway===a.value?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-500"]])},[t("i",{class:E(["pi",l(n).gateway===a.value?"pi-check":"pi-credit-card"])},null,2)],2),t("div",qe,[t("p",Ne,y(a.label),1),e[6]||(e[6]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Instant payment processing ",-1))])])],10,Re))),128))])):k("",!0),T.enabledGateways.filter(a=>a.type==="automatic").length>0&&T.enabledGateways.filter(a=>a.type==="manual").length>0?(m(),b("div",Ue)):k("",!0),T.enabledGateways.filter(a=>a.type==="manual").length>0?(m(),b("div",Oe,[e[8]||(e[8]=t("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"Manual Deposit Methods",-1)),(m(!0),b(U,null,X(T.enabledGateways.filter(a=>a.type==="manual"),a=>(m(),b("div",{key:a.value,onClick:d=>l(n).gateway=a.value,class:E(["p-4 transition-all duration-300 border-2 rounded-lg cursor-pointer",[l(n).gateway===a.value?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"]])},[t("div",De,[t("div",{class:E(["flex items-center justify-center w-12 h-12 rounded-lg transition-all",[l(n).gateway===a.value?"bg-orange-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-500"]])},[t("i",{class:E(["pi",l(n).gateway===a.value?"pi-check":"pi-banknotes"])},null,2)],2),t("div",Ke,[t("p",Le,y(a.label),1),t("p",Xe,y(a.description||"Manual transfer required"),1)])])],10,Ve))),128))])):k("",!0),v(l(D),{severity:"info",closable:!1,class:"mt-4"},{default:x(()=>{var a,d,g,u;return[((a=f.value)==null?void 0:a.type)==="automatic"?(m(),b("p",He," You'll be redirected to "+y((d=f.value)==null?void 0:d.label)+" to complete payment securely. ",1)):((g=f.value)==null?void 0:g.type)==="manual"?(m(),b("p",Je," You'll receive instructions for "+y((u=f.value)==null?void 0:u.label)+" after confirming your deposit. ",1)):k("",!0)]}),_:1}),t("div",Qe,[v(l(A),{label:"Back",icon:"pi pi-arrow-left",outlined:"",onClick:ae}),v(l(A),{label:"Continue",icon:"pi pi-arrow-right",disabled:!l(n).gateway,onClick:W},null,8,["disabled"])])])]}),_:1})):k("",!0),w.value===2&&!G.value?(m(),R(l(V),{key:3,class:"shadow-lg"},{title:x(()=>[...e[9]||(e[9]=[t("div",{class:"flex items-center gap-2 text-lg"},[t("i",{class:"pi pi-dollar text-primary-500"}),M(" Enter Deposit Amount ")],-1)])]),content:x(()=>[t("div",We,[t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},[M(" Amount "),t("span",{class:"text-red-500"},"*")],-1)),v(l(he),{modelValue:l(n).amount,"onUpdate:modelValue":e[0]||(e[0]=s=>l(n).amount=s),mode:"currency",currency:"USD",locale:"en-US",placeholder:"0.00",class:"w-full",min:1,max:te.value},null,8,["modelValue","max"]),t("div",Ze,[t("span",null,"Max per transaction: $"+y((T.depositLimits.perTransaction/100).toFixed(2)),1),t("span",null,"Available today: "+y(l(H)(J.value*100,"USD")),1)])]),J.value<=0?(m(),R(l(D),{key:0,severity:"error",closable:!1},{default:x(()=>[...e[11]||(e[11]=[t("p",{class:"text-sm"},"Daily deposit limit reached",-1)])]),_:1})):k("",!0),v(l(D),{severity:"info",closable:!1},{default:x(()=>{var s,o,a,d;return[t("p",et,[e[12]||(e[12]=t("strong",null,"Gateway:",-1)),M(" "+y((s=f.value)==null?void 0:s.label),1)]),t("p",tt,[e[13]||(e[13]=t("strong",null,"Account:",-1)),M(" "+y((a=(o=I.value)==null?void 0:o.account_type)==null?void 0:a.name)+" (****"+y((d=I.value)==null?void 0:d.account_number.slice(-4))+")",1)])]}),_:1}),t("div",at,[v(l(A),{label:"Back",icon:"pi pi-arrow-left",outlined:"",onClick:ae}),v(l(A),{label:"Proceed to Payment",icon:"pi pi-send",disabled:!Q.value||i.value,loading:i.value,onClick:W},null,8,["disabled","loading"])])])]),_:1})):k("",!0),G.value?(m(),R(l(V),{key:4,class:"shadow-lg"},{content:x(()=>{var s,o,a,d,g,u,h,_,S;return[t("div",rt,[((s=f.value)==null?void 0:s.type)==="automatic"?(m(),b("div",st,[t("div",{class:E(["flex items-center justify-center w-20 h-20 mx-auto mb-4 rounded-full",[p.value==="success"?"bg-green-100 dark:bg-green-900/30":p.value==="error"?"bg-red-100 dark:bg-red-900/30":"bg-blue-100 dark:bg-blue-900/30"]])},[t("i",{class:E(["text-4xl",[p.value==="success"?"pi pi-check-circle text-green-600 dark:text-green-400":p.value==="error"?"pi pi-times-circle text-red-600 dark:text-red-400":"pi pi-spin pi-spinner text-blue-600 dark:text-blue-400"]])},null,2)],2),t("h3",ot,y(p.value==="success"?"Deposit Completed":p.value==="error"?"Confirmation Failed":"Processing Payment"),1),t("p",nt,y(p.value==="success"?"Your deposit has been confirmed successfully.":p.value==="error"?"Payment was received, but we could not confirm it automatically. Please contact support.":`Confirming your payment with ${(o=f.value)==null?void 0:o.label}...`),1)])):((a=f.value)==null?void 0:a.type)==="manual"?(m(),b("div",lt,[e[18]||(e[18]=t("div",{class:"flex items-center justify-center w-20 h-20 mx-auto mb-4 rounded-full bg-orange-100 dark:bg-orange-900/30"},[t("i",{class:"text-4xl pi pi-info-circle text-orange-600 dark:text-orange-400"})],-1)),e[19]||(e[19]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"}," Follow These Instructions ",-1)),t("p",it," Your deposit request has been created. Please follow the instructions below to complete your deposit via "+y((d=f.value)==null?void 0:d.label)+". ",1),v(l(D),{severity:"warning",closable:!1,class:"mt-6 text-left"},{default:x(()=>{var $,j;return[t("div",dt,[t("p",ct,y(($=f.value)==null?void 0:$.label)+" Instructions: ",1),t("div",ut,y(((j=f.value)==null?void 0:j.description)||"Please contact support for instructions"),1)])]}),_:1}),(g=f.value)!=null&&g.instructions&&Object.keys(f.value.instructions).length>0?(m(),b("div",yt,[e[14]||(e[14]=t("p",{class:"font-semibold text-gray-900 dark:text-white mb-3"},"Bank Details:",-1)),t("div",mt,[(m(!0),b(U,null,X(f.value.instructions,($,j)=>(m(),b("div",{key:j,class:"flex justify-between border-b border-gray-200 dark:border-gray-700 pb-2"},[t("span",pt,y(j.replace(/_/g," ")),1),t("span",ft,y($),1)]))),128))])])):k("",!0),t("div",vt,[e[15]||(e[15]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},"Your Deposit Reference:",-1)),t("p",gt,y(((u=F.value)==null?void 0:u.uuid)||"Reference loading..."),1),e[16]||(e[16]=t("p",{class:"text-xs text-gray-500 mt-2"},"Please include this reference when making your deposit",-1))]),v(l(D),{severity:"info",closable:!1,class:"mt-6"},{default:x(()=>[...e[17]||(e[17]=[t("p",{class:"text-sm"},"Once you've completed the transfer, your deposit will be verified and credited to your account.",-1)])]),_:1})])):k("",!0),t("div",bt,[t("div",xt,[t("div",wt,[e[20]||(e[20]=t("span",{class:"text-gray-500"},"Amount",-1)),t("span",ht,y(l(H)(l(n).amount*100,"USD")),1)]),t("div",kt,[e[21]||(e[21]=t("span",{class:"text-gray-500"},"Method",-1)),t("span",_t,y((h=f.value)==null?void 0:h.label),1)]),t("div",Ct,[e[22]||(e[22]=t("span",{class:"text-gray-500"},"Account",-1)),t("span",Pt,y((S=(_=I.value)==null?void 0:_.account_type)==null?void 0:S.name),1)])])]),t("div",Et,[p.value!=="processing"?(m(),R(l(A),{key:0,label:"New Deposit",icon:"pi pi-plus",outlined:"",onClick:ge})):k("",!0),v(l(ee),{href:"/deposits"},{default:x(()=>[v(l(A),{label:"Back to Deposits",icon:"pi pi-arrow-left"})]),_:1})])])]}),_:1})):k("",!0)])]),_:1})],64))}};export{It as default};
